/***********************************************************************************
  Snes9x - Portable Super Nintendo Entertainment System (TM) emulator.

  (c) Copyright 1996 - 2002  Gary Henderson (gary.henderson@ntlworld.com),
                             Jerremy Koot (jkoot@snes9x.com)

  (c) Copyright 2002 - 2004  Matthew Kendora

  (c) Copyright 2002 - 2005  Peter Bortas (peter@bortas.org)

  (c) Copyright 2004 - 2005  Joel Yliluoma (http://iki.fi/bisqwit/)

  (c) Copyright 2001 - 2006  John Weidman (jweidman@slip.net)

  (c) Copyright 2002 - 2006  funkyass (funkyass@spam.shaw.ca),
                             Kris Bleakley (codeviolation@hotmail.com)

  (c) Copyright 2002 - 2010  Brad Jorsch (anomie@users.sourceforge.net),
                             Nach (n-a-c-h@users.sourceforge.net),
                             zones (kasumitokoduck@yahoo.com)

  (c) Copyright 2006 - 2007  nitsuja

  (c) Copyright 2009 - 2010  BearOso,
                             OV2


  BS-X C emulator code
  (c) Copyright 2005 - 2006  Dreamer Nom,
                             zones

  C4 x86 assembler and some C emulation code
  (c) Copyright 2000 - 2003  _Demo_ (_demo_@zsnes.com),
                             Nach,
                             zsKnight (zsknight@zsnes.com)

  C4 C++ code
  (c) Copyright 2003 - 2006  Brad Jorsch,
                             Nach

  DSP-1 emulator code
  (c) Copyright 1998 - 2006  _Demo_,
                             Andreas Naive (andreasnaive@gmail.com),
                             Gary Henderson,
                             Ivar (ivar@snes9x.com),
                             John Weidman,
                             Kris Bleakley,
                             Matthew Kendora,
                             Nach,
                             neviksti (neviksti@hotmail.com)

  DSP-2 emulator code
  (c) Copyright 2003         John Weidman,
                             Kris Bleakley,
                             Lord Nightmare (lord_nightmare@users.sourceforge.net),
                             Matthew Kendora,
                             neviksti

  DSP-3 emulator code
  (c) Copyright 2003 - 2006  John Weidman,
                             Kris Bleakley,
                             Lancer,
                             z80 gaiden

  DSP-4 emulator code
  (c) Copyright 2004 - 2006  Dreamer Nom,
                             John Weidman,
                             Kris Bleakley,
                             Nach,
                             z80 gaiden

  OBC1 emulator code
  (c) Copyright 2001 - 2004  zsKnight,
                             pagefault (pagefault@zsnes.com),
                             Kris Bleakley
                             Ported from x86 assembler to C by sanmaiwashi

  SPC7110 and RTC C++ emulator code used in 1.39-1.51
  (c) Copyright 2002         Matthew Kendora with research by
                             zsKnight,
                             John Weidman,
                             Dark Force

  SPC7110 and RTC C++ emulator code used in 1.52+
  (c) Copyright 2009         byuu,
                             neviksti

  S-DD1 C emulator code
  (c) Copyright 2003         Brad Jorsch with research by
                             Andreas Naive,
                             John Weidman

  S-RTC C emulator code
  (c) Copyright 2001 - 2006  byuu,
                             John Weidman

  ST010 C++ emulator code
  (c) Copyright 2003         Feather,
                             John Weidman,
                             Kris Bleakley,
                             Matthew Kendora

  Super FX x86 assembler emulator code
  (c) Copyright 1998 - 2003  _Demo_,
                             pagefault,
                             zsKnight

  Super FX C emulator code
  (c) Copyright 1997 - 1999  Ivar,
                             Gary Henderson,
                             John Weidman

  Sound emulator code used in 1.5-1.51
  (c) Copyright 1998 - 2003  Brad Martin
  (c) Copyright 1998 - 2006  Charles Bilyue'

  Sound emulator code used in 1.52+
  (c) Copyright 2004 - 2007  Shay Green (gblargg@gmail.com)

  SH assembler code partly based on x86 assembler code
  (c) Copyright 2002 - 2004  Marcus Comstedt (marcus@mc.pp.se)

  2xSaI filter
  (c) Copyright 1999 - 2001  Derek Liauw Kie Fa

  HQ2x, HQ3x, HQ4x filters
  (c) Copyright 2003         Maxim Stepin (maxim@hiend3d.com)

  NTSC filter
  (c) Copyright 2006 - 2007  Shay Green

  GTK+ GUI code
  (c) Copyright 2004 - 2010  BearOso

  Win32 GUI code
  (c) Copyright 2003 - 2006  blip,
                             funkyass,
                             Matthew Kendora,
                             Nach,
                             nitsuja
  (c) Copyright 2009 - 2010  OV2

  Mac OS GUI code
  (c) Copyright 1998 - 2001  John Stiles
  (c) Copyright 2001 - 2010  zones


  Specific ports contains the works of other authors. See headers in
  individual files.


  Snes9x homepage: http://www.snes9x.com/

  Permission to use, copy, modify and/or distribute Snes9x in both binary
  and source form, for non-commercial purposes, is hereby granted without
  fee, providing that this license information and copyright notice appear
  with all copies and any derived work.

  This software is provided 'as-is', without any express or implied
  warranty. In no event shall the authors be held liable for any damages
  arising from the use of this software or it's derivatives.

  Snes9x is freeware for PERSONAL USE only. Commercial users should
  seek permission of the copyright holders first. Commercial use includes,
  but is not limited to, charging money for Snes9x or software derived from
  Snes9x, including Snes9x or derivatives in commercial game bundles, and/or
  using Snes9x as a promotion for your commercial product.

  The copyright holders request that bug fixes and improvements to the code
  should be forwarded to them so everyone can benefit from the modifications
  in future versions.

  Super NES and Super Nintendo Entertainment System are trademarks of
  Nintendo Co., Limited and its subsidiary companies.
 ***********************************************************************************/

#include "snes9x.h"
#include "ppu.h"
#include "tile.h"

static INLINE uint16 COLOR_SUB (uint16 C1, uint16 C2)
{
	uint16	mC1, mC2, v;
	v = ALPHA_BITS_MASK;

	mC1 = C1 & FIRST_COLOR_MASK;
	mC2 = C2 & FIRST_COLOR_MASK;
	if (mC1 > mC2)
		v += (mC1 - mC2);

	mC1 = C1 & SECOND_COLOR_MASK;
	mC2 = C2 & SECOND_COLOR_MASK;
	if (mC1 > mC2)
		v += (mC1 - mC2);

	mC1 = C1 & THIRD_COLOR_MASK;
	mC2 = C2 & THIRD_COLOR_MASK;
	if (mC1 > mC2)
		v += (mC1 - mC2);

	return (v);
}

static uint16	DirectColourMaps[8][256];
static uint16 BlackColourMap[256] = {0};

static void S9xBuildDirectColourMaps (void)
{
	uint32 p, c;
	IPPU.XB = mul_brightness[PPU.Brightness];

	for ( p = 0; p < 8; p++)
		for ( c = 0; c < 256; c++)
			DirectColourMaps[p][c] = BUILD_PIXEL(IPPU.XB[((c & 7) << 2) | ((p & 1) << 1)], IPPU.XB[((c & 0x38) >> 1) | (p & 2)], IPPU.XB[((c & 0xc0) >> 3) | (p & 4)]);

	IPPU.DirectColourMapsNeedRebuild = FALSE;
}

static uint32	pixbit[8][16];
static uint8	hrbit_odd[256];
static uint8	hrbit_even[256];

void S9xInitTileRenderer (void)
{
	register int	i;

	for (i = 0; i < 16; i++)
	{
		register uint32	b;
		b = 0;

	#ifdef LSB_FIRST
		if (i & 8)
			b |= 1;
		if (i & 4)
			b |= 1 << 8;
		if (i & 2)
			b |= 1 << 16;
		if (i & 1)
			b |= 1 << 24;
	#else
		if (i & 8)
			b |= 1 << 24;
		if (i & 4)
			b |= 1 << 16;
		if (i & 2)
			b |= 1 << 8;
		if (i & 1)
			b |= 1;
	#endif

		pixbit[0][i] = b << 0;
		pixbit[1][i] = b << 1;
		pixbit[2][i] = b << 2;
		pixbit[3][i] = b << 3;
		pixbit[4][i] = b << 4;
		pixbit[5][i] = b << 5;
		pixbit[6][i] = b << 6;
		pixbit[7][i] = b << 7;
	}

	for (i = 0; i < 256; i++)
	{
		register uint8 m, s;
		m = 0;
		s = 0;

		if (i & 0x80)
			s |= 8;
		if (i & 0x40)
			m |= 8;
		if (i & 0x20)
			s |= 4;
		if (i & 0x10)
			m |= 4;
		if (i & 0x08)
			s |= 2;
		if (i & 0x04)
			m |= 2;
		if (i & 0x02)
			s |= 1;
		if (i & 0x01)
			m |= 1;

		hrbit_odd[i]  = m;
		hrbit_even[i] = s;
	}
}

/* Here are the tile converters, selected by S9xSelectTileConverter().
   Really, except for the definition of DOBIT and the number of times 
   it is called, they're all the same. */

#define DOBIT(n, i) \
	if ((pix = *(tp + (n)))) \
	{ \
		p1 |= pixbit[(i)][pix >> 4]; \
		p2 |= pixbit[(i)][pix & 0xf]; \
	}

static uint8 ConvertTile2 (uint8 *pCache, uint32 TileAddr, uint32 unused)
{
	register uint8 *tp, line;
	uint32	*p;
	uint32	non_zero;

	tp      = &Memory.VRAM[TileAddr];
	p = (uint32 *) pCache;
	non_zero = 0;

	for (line = 8; line != 0; line--, tp += 2)
	{
		register uint8	pix;
		uint32 p1, p2;
		p1 = 0;
		p2 = 0;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

static uint8 ConvertTile4 (uint8 *pCache, uint32 TileAddr, uint32 unused)
{
	register uint8	*tp, line;
	uint32	*p, non_zero;

	tp = &Memory.VRAM[TileAddr];
	p = (uint32 *) pCache;
	non_zero = 0;

	for (line = 8; line != 0; line--, tp += 2)
	{
		register uint8	pix;
		uint32 p1, p2;
		p1 = 0;
		p2 = 0;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		DOBIT(16, 2);
		DOBIT(17, 3);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

static uint8 ConvertTile8 (uint8 *pCache, uint32 TileAddr, uint32 unused)
{
	register uint8	*tp      = &Memory.VRAM[TileAddr];
	uint32			*p       = (uint32 *) pCache;
	uint32			non_zero = 0;
	uint8			line;

	for (line = 8; line != 0; line--, tp += 2)
	{
		uint32			p1 = 0;
		uint32			p2 = 0;
		register uint8	pix;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		DOBIT(16, 2);
		DOBIT(17, 3);
		DOBIT(32, 4);
		DOBIT(33, 5);
		DOBIT(48, 6);
		DOBIT(49, 7);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

#undef DOBIT

#define DOBIT(n, i) \
	if ((pix = hrbit_odd[*(tp1 + (n))])) \
		p1 |= pixbit[(i)][pix]; \
	if ((pix = hrbit_odd[*(tp2 + (n))])) \
		p2 |= pixbit[(i)][pix];

static uint8 ConvertTile2h_odd (uint8 *pCache, uint32 TileAddr, uint32 Tile)
{
	register uint8	*tp1     = &Memory.VRAM[TileAddr], *tp2;
	uint32			*p       = (uint32 *) pCache;
	uint32			non_zero = 0;
	uint8			line;

	if (Tile == 0x3ff)
		tp2 = tp1 - (0x3ff << 4);
	else
		tp2 = tp1 + (1 << 4);

	for (line = 8; line != 0; line--, tp1 += 2, tp2 += 2)
	{
		uint32			p1 = 0;
		uint32			p2 = 0;
		register uint8	pix;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

static uint8 ConvertTile4h_odd (uint8 *pCache, uint32 TileAddr, uint32 Tile)
{
	register uint8	*tp1     = &Memory.VRAM[TileAddr], *tp2;
	uint32			*p       = (uint32 *) pCache;
	uint32			non_zero = 0;
	uint8			line;

	if (Tile == 0x3ff)
		tp2 = tp1 - (0x3ff << 5);
	else
		tp2 = tp1 + (1 << 5);

	for (line = 8; line != 0; line--, tp1 += 2, tp2 += 2)
	{
		uint32			p1 = 0;
		uint32			p2 = 0;
		register uint8	pix;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		DOBIT(16, 2);
		DOBIT(17, 3);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

#undef DOBIT

#define DOBIT(n, i) \
	if ((pix = hrbit_even[*(tp1 + (n))])) \
		p1 |= pixbit[(i)][pix]; \
	if ((pix = hrbit_even[*(tp2 + (n))])) \
		p2 |= pixbit[(i)][pix];

static uint8 ConvertTile2h_even (uint8 *pCache, uint32 TileAddr, uint32 Tile)
{
	register uint8	line, *tp1, *tp2;
	uint32 *p, non_zero;

	tp1 = &Memory.VRAM[TileAddr];
	p = (uint32 *) pCache;
	non_zero = 0;

	if (Tile == 0x3ff)
		tp2 = tp1 - (0x3ff << 4);
	else
		tp2 = tp1 + (1 << 4);

	for (line = 8; line != 0; line--, tp1 += 2, tp2 += 2)
	{
		register uint8	pix;
		uint32 p1, p2;
		p1 = 0;
		p2 = 0;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

static uint8 ConvertTile4h_even (uint8 *pCache, uint32 TileAddr, uint32 Tile)
{
	register uint8	*tp1, *tp2, line;
	uint32	non_zero, *p;

	tp1 = &Memory.VRAM[TileAddr];
	p = (uint32 *) pCache;
	non_zero= 0;

	if (Tile == 0x3ff)
		tp2 = tp1 - (0x3ff << 5);
	else
		tp2 = tp1 + (1 << 5);

	for (line = 8; line != 0; line--, tp1 += 2, tp2 += 2)
	{
		uint32 p1, p2;
		register uint8	pix;

		p1 = 0;
		p2 = 0;

		DOBIT( 0, 0);
		DOBIT( 1, 1);
		DOBIT(16, 2);
		DOBIT(17, 3);
		*p++ = p1;
		*p++ = p2;
		non_zero |= p1 | p2;
	}

	return (non_zero ? TRUE : BLANK_TILE);
}

#undef DOBIT

static void DrawTile16_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	};

}

static void DrawTile16Add_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    0]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    1]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    2]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    3]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    4]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    5]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    6]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    7]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    0]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    1]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    2]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    3]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    4]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    5]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    6]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    7]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    0]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    1]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    2]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    3]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    4]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    5]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    6]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    7]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    0]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    1]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    2]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    3]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    4]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    5]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    6]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    7]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	};

}

static void DrawTile16AddF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;
	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
}

static void DrawTile16AddS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
}

static void DrawTile16Sub_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  0]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  1]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  2]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  3]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  4]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  5]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  6]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  7]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  0]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  1]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  2]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  3]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  4]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  5]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  6]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  7]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  0]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  1]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  2]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  3]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  4]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  5]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  6]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  7]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  0]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  1]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  2]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  3]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  4]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  5]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  6]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  7]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}

}

static void DrawTile16SubF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 7] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 0] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 1] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 3] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 5] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 7] = GFX.Z2;
			}
		}
	}

}

static void DrawTile16SubS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  0]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     0])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 0] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  1]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     1])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  2]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  3]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     3])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  4]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     4])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  5]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     5])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  6]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     6])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  7]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     7])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 7] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  0]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     0])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 0] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  1]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     1])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  2]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  3]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     3])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  4]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     4])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  5]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     5])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  6]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     6])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  7]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     7])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 7] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  0]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     0])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 0] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  1]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     1])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  2]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  3]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     3])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  4]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     4])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  5]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     5])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  6]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     6])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  7]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     7])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 7] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  0]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     0])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 0] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  1]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     1])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  2]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  3]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     3])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  4]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     4])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  5]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     5])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  6]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     6])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  7]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) |
								  ((0x4000 | 0x0200 | 0x0010)
								   << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     7])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 7] = GFX.Z2;
			};
		}
	};

}

static void (*Renderers_DrawTile16Normal1x1[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount) =
{
	DrawTile16_Normal1x1,
	DrawTile16Add_Normal1x1,
	DrawTile16AddF1_2_Normal1x1,
	DrawTile16AddS1_2_Normal1x1,
	DrawTile16Sub_Normal1x1,
	DrawTile16SubF1_2_Normal1x1, DrawTile16SubS1_2_Normal1x1
};

static void DrawTile16_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;
	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);

	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;

	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] = BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] = BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	}

	if ((BG.Buffered[TileNumber] == 2))
		return;

	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors = &IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) + BG.StartPalette];

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			}
		}
	}
}

static void DrawTile16Add_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber, TileAddr;

	TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] = (GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) +
				((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset]) : GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + 
				(((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset]) : GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]);

				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] = (GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) +
				((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.SubScreen[Offset + 2]) : GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
				(((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.SubScreen[Offset + 2]) : GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.SubScreen[Offset + 4]) :
					GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset + 4]) & 0x20) ? 
					(GFX.SubScreen[Offset + 4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.SubScreen[Offset + 6]) : GFX. FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							    SubScreen[Offset + 6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.SubScreen[Offset + 8]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) +
					((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset]) : GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
					+ ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset]) :
					GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset]) & 0x20) ? 
					 (GFX.SubScreen[Offset]) : GFX.FixedColour) & (0x0400 | 0x0020| 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
					+ ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.SubScreen[Offset + 2]) :
					GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset + 2]) & 0x20) ?
					 (GFX.SubScreen[Offset + 2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) +
					 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.SubScreen[Offset + 4]) :
					GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset + 4]) & 0x20) ? 
					 (GFX.SubScreen[Offset + 4]) : GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 14]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) +
						((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.SubScreen[Offset]) :
						GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (((GFX.SubZBuffer[Offset]) & 0x20)
						    ? (GFX.SubScreen[Offset]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 8])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 8])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 10])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 10])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 12])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 12])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 14])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 14])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 10])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 10])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 14])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 14])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 10])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 10])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 14])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 14])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Sub_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 14]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 14]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	};

}

static void DrawTile16SubS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 14]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] = GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] = GFX.S[Offset + 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] = GFX.S[Offset + 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] = GFX.S[Offset + 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] = GFX.S[Offset + 9] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] = GFX.S[Offset + 11] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] = GFX.S[Offset + 13] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] = GFX.S[Offset + 15] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};

}

static void (*Renderers_DrawTile16Normal2x1[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount) =
{
	DrawTile16_Normal2x1,
	DrawTile16Add_Normal2x1,
	DrawTile16AddF1_2_Normal2x1,
	DrawTile16AddS1_2_Normal2x1,
	DrawTile16Sub_Normal2x1,
	DrawTile16SubF1_2_Normal2x1, DrawTile16SubS1_2_Normal2x1
};

static void DrawTile16_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = ((GFX.ClipColors ? 0 : GFX.SubScreen[Offset]));
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]));
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 4]));
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 6]));
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 8]));
				GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 10]));
				GFX.S[Offset + 11] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 12]));
				GFX.S[Offset + 13] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 14]));
				GFX.S[Offset + 15] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset]));
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]));
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 4]));
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 6]));
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 8]));
				GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 10]));
				GFX.S[Offset + 11] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 12]));
				GFX.S[Offset + 13] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 14]));
				GFX.S[Offset + 15] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] = ((GFX.ClipColors ? 0 : GFX.SubScreen[Offset]));
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]));
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 4]));
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 6]));
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 8]));
				GFX.S[Offset + 9] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 10]));
				GFX.S[Offset + 11] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 12]));
				GFX.S[Offset + 13] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 14]));
				GFX.S[Offset + 15] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset]));
				GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]));
				GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 4]));
				GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 6]));
				GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
				GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 10]));
				GFX.S[Offset + 11] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 12]));
				GFX.S[Offset + 13] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 14]));
				GFX.S[Offset + 15] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	};
}

static void DrawTile16Add_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 2]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 9] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 13] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 15] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset]))) & (((GFX.SubZBuffer[Offset]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 9] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 13] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 12]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 15] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[2]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     8]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 9] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 8]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     10]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     12]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 13] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     14]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 15] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 14]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset]))) & (((GFX.SubZBuffer[Offset]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 3] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[5]))
			{
				GFX.S[Offset + 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 5] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[4]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 7] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[3]))
			{
				GFX.S[Offset + 8] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     8]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[2]))
			{
				GFX.S[Offset + 10] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 11] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 10]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[1]))
			{
				GFX.S[Offset + 12] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     12]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 13] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[0]))
			{
				GFX.S[Offset + 14] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     14]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 15] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	}

}

static void DrawTile16AddF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 4] = GFX.DB[Offset + 5] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[3]))
			{
				GFX.S[Offset + 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 6] = GFX.DB[Offset + 7] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 8] && (Pix = bp[4]))
			{
				GFX.S[Offset + 8] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 9] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 8] = GFX.DB[Offset + 9] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 10] && (Pix = bp[5]))
			{
				GFX.S[Offset + 10] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 11] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 10] = GFX.DB[Offset + 11] = GFX.Z2;
			}

			if (GFX.Z1 > GFX.DB[Offset + 12] && (Pix = bp[6]))
			{
				GFX.S[Offset + 12] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 13] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 12] = GFX.DB[Offset + 13] = GFX.Z2;
			}
			if (GFX.Z1 > GFX.DB[Offset + 14] && (Pix = bp[7]))
			{
				GFX.S[Offset + 14] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 15] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 14] = GFX.DB[Offset + 15] = GFX.Z2;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
			{
				GFX.S[Offset] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Sub_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset])),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2])),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 3] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2] = GFX.DB[Offset + 3] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
			{
				GFX.S[Offset] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset] = GFX.DB[Offset + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void (*Renderers_DrawTile16Hires[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount) =
{
	DrawTile16_Hires,
	DrawTile16Add_Hires,
	DrawTile16AddF1_2_Hires,
	DrawTile16AddS1_2_Hires,
	DrawTile16Sub_Hires, DrawTile16SubF1_2_Hires, DrawTile16SubS1_2_Hires
};

static void DrawTile16_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Add_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Sub_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};
}

static void DrawTile16SubF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void (*Renderers_DrawTile16Interlace[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount) =
{
	DrawTile16_Interlace,
	DrawTile16Add_Interlace,
	DrawTile16AddF1_2_Interlace,
	DrawTile16AddS1_2_Interlace,
	DrawTile16Sub_Interlace,
	DrawTile16SubF1_2_Interlace, DrawTile16SubS1_2_Interlace
};

static void DrawTile16_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
				GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
				GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
				GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
				GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
				GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
				GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
				GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
				GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
				GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
				GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
				GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
				GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
				GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
				GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
				GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
				GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
				GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
				GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
				GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
				GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
				GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
				GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
				GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
				GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
				GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
				GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
				GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
				GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
				GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
				GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
				GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
				GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Add_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 2]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 2]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 2]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 0]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     0]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													0]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    0]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    0])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 1]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     1]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													1]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    1]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    1])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 2]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     2]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													2]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    2]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    2])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 3]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     3]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													3]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    3]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    3])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 4]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     4]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													4]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    4]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    4])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 5]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     5]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													5]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    5]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    5])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 6]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     6]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													6]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    6]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    6])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													RealScreenColors
													[Pix]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * 7]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     7]) & 0x20)
				     ? (GFX.
					     RealScreenColors[Pix]) :
				     GFX.
				     FixedColour) & (0x0400 | 0x0020
					     | 0x0001))]);
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))
							 +
							 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													7]) :
							   GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[Pix])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    7]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    7])
					    : GFX.
					    FixedColour) & (0x0400 | 0x0020
						    | 0x0001))]);
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[Pix])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								 +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001)))
							 | 0x0000)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16AddS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 0]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     0]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     0]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     0]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    0]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    0]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  0]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 1]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     1]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     1]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     1]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     1]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    1]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    1]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  1]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 2]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     2]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     2]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     2]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     2]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    2]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    2]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  2]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 3]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     3]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     3]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     3]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     3]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    3]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    3]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  3]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 4]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     4]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     4]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     4]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     4]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    4]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    4]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  4]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 5]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     5]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     5]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     5]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     5]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    5]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    5]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  5]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 6]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     6]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     6]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     6]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     6]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    6]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    6]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  6]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 7]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     7]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     7]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) :
					     GFX.
					     FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 |
												 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     7]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     7]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer
								    [Offset +
								    2 *
								    7]) & 0x20)
						    ? (GFX.
							    SubScreen
							    [Offset +
							    2 *
							    7]) : GFX.
						    FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
								  SubZBuffer
								  [Offset
								  +
								  2 *
								  7]) &
							  0x20)
						  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16Sub_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 0 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  0]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 1 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  1]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 2 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  2]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 3 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  3]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 4 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  4]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 5 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  5]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 6 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  6]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  RealScreenColors
						  [Pix]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * 7 + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[Pix]),
					  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
						  SubScreen
						  [Offset +
						  2 *
						  7]) : GFX.
					  FixedColour));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
					 : (GFX.
						 ZERO[((((GFX.
										 ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010)
										 << 1)) -
							 ((GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
						 1]));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void DrawTile16SubS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
			{
				GFX.S[Offset + 2 * 0] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  0]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 0])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 0 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  0]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     0])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
			{
				GFX.S[Offset + 2 * 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  1]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 1])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 1 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  1]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  1]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     1])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
			{
				GFX.S[Offset + 2 * 2] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  2]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 2])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 2 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  2]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  2]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     2])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
			{
				GFX.S[Offset + 2 * 3] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  3]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 3])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 3 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  3]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  3]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     3])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
			{
				GFX.S[Offset + 2 * 4] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  4]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 4])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 4 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  4]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  4]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     4])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
			{
				GFX.S[Offset + 2 * 5] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  5]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 5])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 5 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  5]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  5]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     5])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
			{
				GFX.S[Offset + 2 * 6] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  6]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 6])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 6 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  6]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  6]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     6])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] = GFX.Z2;
			};
			if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
			{
				GFX.S[Offset + 2 * 7] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  7]))) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1))
							  -
							  (((GFX.
							     RealScreenColors[Pix])) &
							   (~
							    (0x0400 | 0x0020 |
							     0x0001)))) >> 1] :
						  COLOR_SUB (((GFX.
									  ClipColors ? 0 : GFX.
									  SubScreen[Offset +
									  2 * 7])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * 7 + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  7]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  7]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[Pix])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     7])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [Pix]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] = GFX.Z2;
			};
		}
	};

}

static void (*Renderers_DrawTile16HiresInterlace[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 LineCount) =
{
	DrawTile16_HiresInterlace,
	DrawTile16Add_HiresInterlace,
	DrawTile16AddF1_2_HiresInterlace,
	DrawTile16AddS1_2_HiresInterlace,
	DrawTile16Sub_HiresInterlace,
	DrawTile16SubF1_2_HiresInterlace, DrawTile16SubS1_2_HiresInterlace
};

static void DrawClippedTile16_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Add_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    0]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    1]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    2]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    3]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    4]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    5]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    6]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    7]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    0]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    1]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    2]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    3]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    4]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    5]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    6]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    7]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    0]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    1]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    2]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    3]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    4]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    5]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    6]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    7]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    0]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    1]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    2]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    3]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    4]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    5]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    6]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
														    SubScreen
														    [Offset +
														    7]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Sub_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  0]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     0])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  1]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     1])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  2]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  3]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     3])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  4]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     4])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  5]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     5])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  6]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     6])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  7]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     7])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  0]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     0])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  1]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     1])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  2]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  3]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     3])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  4]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     4])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  5]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     5])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  6]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     6])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  7]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     7])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  0]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     0])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  1]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     1])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  2]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  3]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     3])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  4]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     4])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  5]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     5])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  6]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     6])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  7]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     7])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  0]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     0])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 0] = GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  1]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     1])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 1] = GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  2]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 2] = GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  3]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     3])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 3] = GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  4]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     4])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 4] = GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  5]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     5])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 5] = GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  6]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     6])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 6] = GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset +
									  7]) : GFX.
								  FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 | 0x0010)
										   << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     7])) & (~(0x0400
										     |
										     0x0020
										     |
										     0x0001))))
								  >> 1] : COLOR_SUB ((GFX.
										  ScreenColors
										  [Pix]),
									  GFX.
									  FixedColour)));
						GFX.DB[Offset + 7] = GFX.Z2;
					};
					break;
			}
		}
	};

}

static void (*Renderers_DrawClippedTile16Normal1x1[7]) (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount) =
{
	DrawClippedTile16_Normal1x1,
	DrawClippedTile16Add_Normal1x1,
	DrawClippedTile16AddF1_2_Normal1x1,
	DrawClippedTile16AddS1_2_Normal1x1,
	DrawClippedTile16Sub_Normal1x1,
	DrawClippedTile16SubF1_2_Normal1x1, DrawClippedTile16SubS1_2_Normal1x1
};

static void DrawClippedTile16_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Add_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Sub_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void (*Renderers_DrawClippedTile16Normal2x1[7]) (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount) =
{
	DrawClippedTile16_Normal2x1,
	DrawClippedTile16Add_Normal2x1,
	DrawClippedTile16AddF1_2_Normal2x1,
	DrawClippedTile16AddS1_2_Normal2x1,
	DrawClippedTile16Sub_Normal2x1,
	DrawClippedTile16SubF1_2_Normal2x1, DrawClippedTile16SubS1_2_Normal2x1
};

static void DrawClippedTile16_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Add_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};
}

static void DrawClippedTile16AddS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Sub_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + StartLine;
		for (l = LineCount; l > 0; l--, bp += 8 * 1, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset])),
								  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - StartLine;
		for (l = LineCount; l > 0; l--, bp -= 8, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset])),
								  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void (*Renderers_DrawClippedTile16Hires[7]) (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount) =
{
	DrawClippedTile16_Hires,
	DrawClippedTile16Add_Hires,
	DrawClippedTile16AddF1_2_Hires,
	DrawClippedTile16AddS1_2_Hires,
	DrawClippedTile16Sub_Hires,
	DrawClippedTile16SubF1_2_Hires, DrawClippedTile16SubS1_2_Hires
};

static void DrawClippedTile16_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Add_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[0]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Sub_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset] && (Pix = bp[7]))
					{
						GFX.S[Offset] = GFX.S[Offset + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset] = GFX.DB[Offset + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] = GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] = GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] = GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] = GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] = GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] = GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] = GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] = GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void (*Renderers_DrawClippedTile16Interlace[7]) (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount) =
{
	DrawClippedTile16_Interlace,
	DrawClippedTile16Add_Interlace,
	DrawClippedTile16AddF1_2_Interlace,
	DrawClippedTile16AddS1_2_Interlace,
	DrawClippedTile16Sub_Interlace,
	DrawClippedTile16SubF1_2_Interlace, DrawClippedTile16SubS1_2_Interlace
};

static void DrawClippedTile16_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]));
						GFX.S[Offset + 2 * 0 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]));
						GFX.S[Offset + 2 * 1 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]));
						GFX.S[Offset + 2 * 2 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]));
						GFX.S[Offset + 2 * 3 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]));
						GFX.S[Offset + 2 * 4 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]));
						GFX.S[Offset + 2 * 5 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]));
						GFX.S[Offset + 2 * 6 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]));
						GFX.S[Offset + 2 * 7 + 1] = (GFX.ScreenColors[Pix]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Add_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 0]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 0]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     0]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															0])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    0]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    0]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 1]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 1]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     1]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															1])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    1]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    1]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 2]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 2]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     2]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															2])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    2]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    2]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 3]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 3]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     3]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															3])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    3]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    3]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 4]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 4]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     4]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															4])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    4]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    4]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 5]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 5]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     5]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															5])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    5]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    5]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 6]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 6]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     6]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															6])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    6]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    6]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 7]))) & (~(0x0400 | 0x0020 | 0x0001)))
									 +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															RealScreenColors
															[Pix])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 * 7]))) & (((GFX.SubZBuffer[Offset +
								     2 *
								     7]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
						     FixedColour) & (0x0400 |
							     0x0020 |
							     0x0001))]);
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
													 0x0001))) +
									 ((((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
															SubScreen
															[Offset
															+
															2 *
															7])
									   : GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
								 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer[Offset +
									    2 *
									    7]) & 0x20)
							    ? (GFX.
								    SubScreen[Offset +
								    2 *
								    7]) : GFX.
							    FixedColour) & (0x0400 |
								    0x0020 |
								    0x0001))]);
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 0]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     0]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 1]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     1]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 2]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     2]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 3]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     3]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 4]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     4]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 5]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     5]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 6]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     6]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))])
							 : (((((((((GFX.ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 *
																 7]))) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset +
										     2 *
										     7]))) & (GFX.
									     FixedColour) & (0x0400 |
										     0x0020 |
										     0x0001))) |
									 0x0000)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.ScreenColors[Pix])) & (GFX.
									 FixedColour)
								  & (0x0400 | 0x0020 | 0x0001))])
							 : ((((((((GFX.
															 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
																 0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
											 >> 1) +
										 (((GFX.ScreenColors[Pix])) & (GFX.
											 FixedColour) & (0x0400
												 |
												 0x0020
												 |
												 0x0001)))
									 | 0x0000)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16AddS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 0]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     0]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     0]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     0]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     0]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    0]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    0]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  0])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 0])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 0])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 1]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     1]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     1]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     1]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     1]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    1]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    1]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  1])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 1])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 1])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 2]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     2]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     2]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     2]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     2]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    2]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    2]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  2])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 2])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 2])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 3]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     3]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     3]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     3]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     3]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    3]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    3]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  3])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 3])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 3])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 4]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     4]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     4]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     4]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     4]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    4]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    4]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  4])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 4])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 4])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 5]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     5]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     5]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     5]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     5]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    5]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    5]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  5])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 5])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 5])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 6]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     6]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     6]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     6]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     6]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    6]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    6]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  6])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 6])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 6])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 7]))) & (~(0x0400 |
														 0x0020 |
														 0x0001))) +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     RealScreenColors
										     [Pix]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     7]))) & (((GFX.
									     SubZBuffer
									     [Offset +
									     2 *
									     7]) & 0x20)
							     ? (GFX.
								     RealScreenColors
								     [Pix]) : GFX.
							     FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors ? (GFX.
								 X2[(((((GFX.
													 ScreenColors[Pix])) & (~(0x0400 |
														 0x0020 |
														 0x0001)))
										 +
										 ((((GFX.
										     SubZBuffer[Offset +
										     2 *
										     7]) & 0x20) ? (GFX.
										     SubScreen
										     [Offset
										     +
										     2 *
										     7]) :
										   GFX.
										   FixedColour) & (~(0x0400 | 0x0020 |
												   0x0001)))) >> 1) +
								 (((GFX.
								    ScreenColors[Pix])) & (((GFX.
										    SubZBuffer
										    [Offset +
										    2 *
										    7]) & 0x20)
								    ? (GFX.
									    SubScreen
									    [Offset +
									    2 *
									    7]) : GFX.
								    FixedColour) &
								  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
										  SubZBuffer
										  [Offset
										  +
										  2 *
										  7])
									  &
									  0x20)
								  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * 7])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * 7])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16Sub_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 0])),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 0 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  0]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 1])),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 1 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  1]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 2])),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 2 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  2]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 3])),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 3 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  3]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 4])),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 4 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  4]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 5])),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 5 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  5]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 6])),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 6 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  6]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * 7])),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour));
						GFX.S[Offset + 2 * 7 + 1] =
							(COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  7]) : GFX.
							  FixedColour));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  GFX.FixedColour)) : (GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  ((GFX.
									    FixedColour) & (~(0x0400
											    |
											    0x0020
											    |
											    0x0001))))
								  >> 1]));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
							 : (GFX.
								 ZERO[((((GFX.
												 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
													 0x0010) << 1)) -
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
								 >> 1]));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void DrawClippedTile16SubS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l;
	register uint8 *bp, Pix, w;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (!(Tile & (0x8000 | 0x4000)))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x8000))
	{
		bp = pCache + (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp += 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else if (!(Tile & 0x4000))
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	}
	else
	{
		bp = pCache + 56 - (StartLine * 2 + BG.InterlaceLine);
		for (l = LineCount; l > 0; l--, bp -= 8 * 2, Offset += GFX.PPL)
		{
			w = Width;
			switch (StartPixel)
			{
				case 0:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 0] && (Pix = bp[7]))
					{
						GFX.S[Offset + 2 * 0] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 0])),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  0]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 0])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 0 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 0]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  0]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  0]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     0])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 0] = GFX.DB[Offset + 2 * 0 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 1:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 1] && (Pix = bp[6]))
					{
						GFX.S[Offset + 2 * 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 1])),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  1]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 1])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 1 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 1]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  1]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  1]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     1])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 1] = GFX.DB[Offset + 2 * 1 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 2:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 2] && (Pix = bp[5]))
					{
						GFX.S[Offset + 2 * 2] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 2])),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  2]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 2])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 2 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 2]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  2]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  2]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     2])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 2] = GFX.DB[Offset + 2 * 2 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 3:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 3] && (Pix = bp[4]))
					{
						GFX.S[Offset + 2 * 3] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 3])),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  3]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 3])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 3 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 3]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  3]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  3]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     3])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 3] = GFX.DB[Offset + 2 * 3 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 4:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 4] && (Pix = bp[3]))
					{
						GFX.S[Offset + 2 * 4] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 4])),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  4]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 4])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 4 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 4]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  4]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  4]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     4])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 4] = GFX.DB[Offset + 2 * 4 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 5:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 5] && (Pix = bp[2]))
					{
						GFX.S[Offset + 2 * 5] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 5])),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  5]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 5])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 5 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 5]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  5]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  5]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     5])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 5] = GFX.DB[Offset + 2 * 5 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 6:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 6] && (Pix = bp[1]))
					{
						GFX.S[Offset + 2 * 6] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 6])),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  6]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 6])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 6 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 6]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  6]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  6]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     6])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 6] = GFX.DB[Offset + 2 * 6 + 1] =
							GFX.Z2;
					};
					if (!--w)
						break;
				case 7:
					if (GFX.Z1 > GFX.DB[Offset + 2 * 7] && (Pix = bp[0]))
					{
						GFX.S[Offset + 2 * 7] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 (((GFX.ClipColors ? 0 : GFX.
								    SubScreen[Offset + 2 * 7])),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  RealScreenColors
									  [Pix]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[(((((GFX.
													  ClipColors ? 0 : GFX.
													  SubScreen[Offset +
													  2 *
													  7]))) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     RealScreenColors[Pix]))
									   &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB (((GFX.
											  ClipColors ? 0 :
											  GFX.
											  SubScreen[Offset +
											  2 * 7])),
									  GFX.FixedColour)));
						GFX.S[Offset + 2 * 7 + 1] =
							(GFX.
							 ClipColors
							 ? (COLOR_SUB
								 ((GFX.ScreenColors[Pix]),
								  ((GFX.SubZBuffer[Offset + 2 * 7]) & 0x20) ? (GFX.
									  SubScreen
									  [Offset
									  +
									  2 *
									  7]) :
								  GFX.FixedColour)) : (((GFX.
										  SubZBuffer[Offset +
										  2 *
										  7]) & 0x20) ? GFX.
								  ZERO[((((GFX.
												  ScreenColors[Pix])) |
										  ((0x4000 | 0x0200 |
										    0x0010) << 1)) -
									  (((GFX.
									     SubScreen[Offset +
									     2 *
									     7])) &
									   (~
									    (0x0400 | 0x0020 |
									     0x0001)))) >> 1] :
								  COLOR_SUB ((GFX.
										  ScreenColors[Pix]),
									  GFX.FixedColour)));
						GFX.DB[Offset + 2 * 7] = GFX.DB[Offset + 2 * 7 + 1] =
							GFX.Z2;
					};
					break;
			}
		}
	};

}

static void (*Renderers_DrawClippedTile16HiresInterlace[7]) (uint32 Tile, uint32 Offset, uint32 StartPixel, uint32 Width, uint32 StartLine, uint32 LineCount) =
{
	DrawClippedTile16_HiresInterlace,
	DrawClippedTile16Add_HiresInterlace,
	DrawClippedTile16AddF1_2_HiresInterlace,
	DrawClippedTile16AddS1_2_HiresInterlace,
	DrawClippedTile16Sub_HiresInterlace,
	DrawClippedTile16SubF1_2_HiresInterlace,
	DrawClippedTile16SubS1_2_HiresInterlace
};

static void DrawMosaicPixel16_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Add_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + w]) & 0x20) ? (GFX.
													    SubScreen
													    [Offset +
													    w]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    w]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    w]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400 |
											 0x0020 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     w]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset +
									     w]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    w]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    w]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  w]) &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + w])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + w])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Sub_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + w]) & 0x20) ? (GFX.
							  SubScreen[Offset
							  +
							  w]) :
						  GFX.FixedColour));
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubF1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubS1_2_Normal1x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + w])
				{
					GFX.S[Offset + w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + w]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  w]) : GFX.
							  FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  w]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010) <<
									   1)) -
								  (((GFX.
								     SubScreen[Offset +
								     w])) & (~(0x0400 |
									     0x0020 |
									     0x0001))))
							  >> 1] : COLOR_SUB ((GFX.
									  ScreenColors
									  [Pix]),
								  GFX.
								  FixedColour)));
					GFX.DB[Offset + w] = GFX.Z2;
				};
		}
	};

}

static void (*Renderers_DrawMosaicPixel16Normal1x1[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount) =
{
	DrawMosaicPixel16_Normal1x1,
	DrawMosaicPixel16Add_Normal1x1,
	DrawMosaicPixel16AddF1_2_Normal1x1,
	DrawMosaicPixel16AddS1_2_Normal1x1,
	DrawMosaicPixel16Sub_Normal1x1,
	DrawMosaicPixel16SubF1_2_Normal1x1, DrawMosaicPixel16SubS1_2_Normal1x1
};

static void DrawMosaicPixel16_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Add_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														w]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    w]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    w]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400 |
											 0x0020 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset +
									     2 *
									     w]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    w]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    w]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * w])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * w])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Sub_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  w]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubF1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubS1_2_Normal2x1 (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  w]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     w])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void (*Renderers_DrawMosaicPixel16Normal2x1[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount) =
{
	DrawMosaicPixel16_Normal2x1,
	DrawMosaicPixel16Add_Normal2x1,
	DrawMosaicPixel16AddF1_2_Normal2x1,
	DrawMosaicPixel16AddS1_2_Normal2x1,
	DrawMosaicPixel16Sub_Normal2x1,
	DrawMosaicPixel16SubF1_2_Normal2x1, DrawMosaicPixel16SubS1_2_Normal2x1
};

static void DrawMosaicPixel16_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]));
					GFX.S[Offset + 2 * w + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Add_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 w]))) & (~(0x0400 | 0x0020 | 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * w]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     w]) & 0x20)
					     ? (GFX.
						     RealScreenColors[Pix]) :
					     GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														w]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    w]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    w]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 w]))) & (~(0x0400 | 0x0020
													 | 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     w]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 w]))) & (~(0x0400 | 0x0020 | 0x0001)))
											 +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     w]))) & (GFX.
								     FixedColour) & (0x0400 | 0x0020
									     | 0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400 |
											 0x0020 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 w]))) & (~(0x0400 | 0x0020
													 | 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     w]))) & (((GFX.
								     SubZBuffer[Offset
								     +
								     2 *
								     w]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
						     GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset +
									     2 *
									     w]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    w]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    w]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * w])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * w])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Sub_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) : GFX.
						  FixedColour));
					GFX.S[Offset + 2 * w + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  w]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubF1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  w]))) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400 |
										    0x0020 |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubS1_2_Hires (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - StartLine + StartPixel];
	else
		Pix = pCache[StartLine + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  w]))) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     RealScreenColors[Pix])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 : GFX.
										  SubScreen[Offset +
										  2 * w])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  w]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     w])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void (*Renderers_DrawMosaicPixel16Hires[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount) =
{
	DrawMosaicPixel16_Hires,
	DrawMosaicPixel16Add_Hires,
	DrawMosaicPixel16AddF1_2_Hires,
	DrawMosaicPixel16AddS1_2_Hires,
	DrawMosaicPixel16Sub_Hires,
	DrawMosaicPixel16SubF1_2_Hires, DrawMosaicPixel16SubS1_2_Hires
};

static void DrawMosaicPixel16_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Add_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														w]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    w]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    w]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400 |
											 0x0020 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset +
									     2 *
									     w]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    w]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    w]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * w])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * w])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Sub_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  w]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubF1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubS1_2_Interlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] = GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  w]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     w])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void (*Renderers_DrawMosaicPixel16Interlace[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount) =
{
	DrawMosaicPixel16_Interlace,
	DrawMosaicPixel16Add_Interlace,
	DrawMosaicPixel16AddF1_2_Interlace,
	DrawMosaicPixel16AddS1_2_Interlace,
	DrawMosaicPixel16Sub_Interlace,
	DrawMosaicPixel16SubF1_2_Interlace, DrawMosaicPixel16SubS1_2_Interlace
};

static void DrawMosaicPixel16_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]));
					GFX.S[Offset + 2 * w + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Add_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 w]))) & (~(0x0400 | 0x0020 | 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * w]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     w]) & 0x20)
					     ? (GFX.
						     RealScreenColors[Pix]) :
					     GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														w]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
						 +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    w]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    w]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 w]))) & (~(0x0400 | 0x0020
													 | 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     w]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 w]))) & (~(0x0400 | 0x0020 | 0x0001)))
											 +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     w]))) & (GFX.
								     FixedColour) & (0x0400 | 0x0020
									     | 0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
										 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400 |
											 0x0020 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16AddS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 w]))) & (~(0x0400 | 0x0020
													 | 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     w]))) & (((GFX.
								     SubZBuffer[Offset
								     +
								     2 *
								     w]) &
							     0x20) ? (GFX.
								     RealScreenColors
								     [Pix]) :
						     GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     w]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset +
									     2 *
									     w]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    w]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    w]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  w]) &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * w])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * w])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16Sub_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) : GFX.
						  FixedColour));
					GFX.S[Offset + 2 * w + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  w]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubF1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  w]))) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400 |
										    0x0020 |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void DrawMosaicPixel16SubS1_2_HiresInterlace (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount)
{

	uint8 *pCache;
	register int32 l, w;
	register uint8 Pix;
	uint32 TileNumber;
	uint32 TileAddr = BG.TileAddress + ((Tile & 0x3ff) << BG.TileShift);
	if (Tile & 0x100)
		TileAddr += BG.NameSelect;
	TileAddr &= 0xffff;
	TileNumber = TileAddr >> BG.TileShift;
	if (Tile & 0x4000)
	{
		pCache = &BG.BufferFlip[TileNumber << 6];
		if (!BG.BufferedFlip[TileNumber])
			BG.BufferedFlip[TileNumber] =
				BG.ConvertTileFlip (pCache, TileAddr, Tile & 0x3ff);
	}
	else
	{
		pCache = &BG.Buffer[TileNumber << 6];
		if (!BG.Buffered[TileNumber])
			BG.Buffered[TileNumber] =
				BG.ConvertTile (pCache, TileAddr, Tile & 0x3ff);
	};
	if ((BG.Buffered[TileNumber] == 2))
		return;
	if (BG.DirectColourMode)
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[(Tile >> 10) & 7];
	}
	else
		GFX.RealScreenColors =
			&IPPU.ScreenColors[((Tile >> BG.PaletteShift) & BG.PaletteMask) +
			BG.StartPalette];
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	if (Tile & 0x4000)
		StartPixel = 7 - StartPixel;
	if (Tile & 0x8000)
		Pix = pCache[56 - (StartLine * 2 + BG.InterlaceLine) + StartPixel];
	else
		Pix = pCache[(StartLine * 2 + BG.InterlaceLine) + StartPixel];
	if (Pix)
	{
		for (l = LineCount; l > 0; l--, Offset += GFX.PPL)
		{
			for (w = Width - 1; w >= 0; w--)
				if (GFX.Z1 > GFX.DB[Offset + 2 * w])
				{
					GFX.S[Offset + 2 * w] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w])),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  w]))) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     RealScreenColors[Pix])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 : GFX.
										  SubScreen[Offset +
										  2 * w])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * w + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * w]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  2 *
								  w]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  w]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     w])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * w] = GFX.DB[Offset + 2 * w + 1] = GFX.Z2;
				};
		}
	};

}

static void (*Renderers_DrawMosaicPixel16HiresInterlace[7]) (uint32 Tile, uint32 Offset, uint32 StartLine, uint32 StartPixel, uint32 Width, uint32 LineCount) =
{
	DrawMosaicPixel16_HiresInterlace,
	DrawMosaicPixel16Add_HiresInterlace,
	DrawMosaicPixel16AddF1_2_HiresInterlace,
	DrawMosaicPixel16AddS1_2_HiresInterlace,
	DrawMosaicPixel16Sub_HiresInterlace,
	DrawMosaicPixel16SubF1_2_HiresInterlace,
	DrawMosaicPixel16SubS1_2_HiresInterlace
};

static void DrawBackdrop16_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] = (GFX.ScreenColors[0]);
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void DrawBackdrop16Add_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
												    SubScreen
												    [Offset +
												    x]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[0])) & (((GFX.
							    SubZBuffer[Offset +
							    x]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    x]) :
					    GFX.
					    FixedColour) & (0x0400 | 0x0020 |
						    0x0001))]);
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void DrawBackdrop16AddF1_2_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[0])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
								 (((GFX.ScreenColors[0])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001))) |
							 0x0000)));
				GFX.DB[Offset + x] = 1;
			};
	};

}
static void DrawBackdrop16AddS1_2_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     x]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     x]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[0])) & (((GFX.
								    SubZBuffer[Offset +
								    x]) &
							    0x20) ? (GFX.
								    SubScreen
								    [Offset +
								    x]) : GFX.
						    FixedColour) & (0x0400
							    |
							    0x0020
							    |
							    0x0001))])
							    : (((GFX.
											    SubZBuffer[Offset +
											    x]) & 0x20)
									    ? (((((((GFX.
																    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001)))
													    +
													    (((GFX.
													       SubScreen[Offset +
													       x])) & (~(0x0400 | 0x0020 | 0x0001)))) >>
												    1) +
											    (((GFX.ScreenColors[0])) & ((GFX.
													    SubScreen[Offset +
													    x])) & (0x0400 |
													    0x0020 |
													    0x0001)))
										    | 0x0000) : GFX.
									    X2[(((((GFX.
														    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
											    ((GFX.
											      FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
									    +
									    (((GFX.ScreenColors[0])) & (GFX.
										    FixedColour) & (0x0400 |
											    0x0020 |
											    0x0001))]));
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void DrawBackdrop16Sub_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(COLOR_SUB
					 ((GFX.ScreenColors[0]),
					  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
						  SubScreen[Offset +
						  x]) : GFX.
					  FixedColour));
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void DrawBackdrop16SubF1_2_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[0]), GFX.FixedColour)) : (GFX.
						 ZERO[((((GFX.ScreenColors[0])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void DrawBackdrop16SubS1_2_Normal1x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + x])
			{
				GFX.S[Offset + x] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[0]),
						  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
							  SubScreen[Offset +
							  x]) :
						  GFX.FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  x]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[0])) | ((0x4000
											  |
											  0x0200
											  |
											  0x0010)
										  << 1)) -
							  (((GFX.
							     SubScreen[Offset +
							     x])) & (~(0x0400 |
								     0x0020 |
								     0x0001))))
						  >> 1] : COLOR_SUB ((GFX.
								  ScreenColors
								  [0]),
							  GFX.
							  FixedColour)));
				GFX.DB[Offset + x] = 1;
			};
	};

}

static void (*Renderers_DrawBackdrop16Normal1x1[7]) (uint32 Offset, uint32 Left, uint32 Right) =
{
	DrawBackdrop16_Normal1x1,
	DrawBackdrop16Add_Normal1x1,
	DrawBackdrop16AddF1_2_Normal1x1,
	DrawBackdrop16AddS1_2_Normal1x1,
	DrawBackdrop16Sub_Normal1x1,
	DrawBackdrop16SubF1_2_Normal1x1, DrawBackdrop16SubS1_2_Normal1x1
};

static void DrawBackdrop16_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.ScreenColors[0]);
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16Add_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													x]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[0])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    x]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    x]) :
					    GFX.
					    FixedColour) & (0x0400 | 0x0020 |
						    0x0001))]);
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16AddF1_2_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[0])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
								 (((GFX.ScreenColors[0])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001))) |
							 0x0000)));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16AddS1_2_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     x]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     x]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[0])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) &
							    0x20) ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
						    FixedColour) & (0x0400
							    |
							    0x0020
							    |
							    0x0001))])
							    : (((GFX.
											    SubZBuffer[Offset +
											    2 *
											    x]) & 0x20)
									    ? (((((((GFX.
																    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001)))
													    +
													    (((GFX.
													       SubScreen[Offset +
													       2 *
													       x])) & (~(0x0400 | 0x0020 | 0x0001)))) >>
												    1) +
											    (((GFX.ScreenColors[0])) & ((GFX.
													    SubScreen[Offset +
													    2 *
													    x])) & (0x0400 |
													    0x0020 |
													    0x0001)))
										    | 0x0000) : GFX.
									    X2[(((((GFX.
														    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
											    ((GFX.
											      FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
									    +
									    (((GFX.ScreenColors[0])) & (GFX.
										    FixedColour) & (0x0400 |
											    0x0020 |
											    0x0001))]));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16Sub_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[0]),
					  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
						  SubScreen[Offset
						  +
						  2 *
						  x]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16SubF1_2_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[0]), GFX.FixedColour)) : (GFX.
						 ZERO[((((GFX.ScreenColors[0])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16SubS1_2_Normal2x1 (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[0]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  x]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[0])) | ((0x4000 |
											  0x0200 |
											  0x0010) <<
										  1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     x])) & (~(0x0400 |
								     0x0020 |
								     0x0001)))) >>
						  1] : COLOR_SUB ((GFX.
								  ScreenColors[0]),
							  GFX.FixedColour)));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void (*Renderers_DrawBackdrop16Normal2x1[7]) (uint32 Offset, uint32 Left, uint32 Right) =
{
	DrawBackdrop16_Normal2x1,
	DrawBackdrop16Add_Normal2x1,
	DrawBackdrop16AddF1_2_Normal2x1,
	DrawBackdrop16AddS1_2_Normal2x1,
	DrawBackdrop16Sub_Normal2x1,
	DrawBackdrop16SubF1_2_Normal2x1, DrawBackdrop16SubS1_2_Normal2x1
};

static void DrawBackdrop16_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]));
				GFX.S[Offset + 2 * x + 1] = (GFX.ScreenColors[0]);
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16Add_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(GFX.
					 X2[((((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
													RealScreenColors
													[0]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 ((((GFX.ClipColors ? 0 : GFX.
					     SubScreen[Offset +
					     2 * x]))) & (((GFX.SubZBuffer[Offset +
						     2 *
						     x]) & 0x20)
				     ? (GFX.
					     RealScreenColors[0]) : GFX.
				     FixedColour) & (0x0400 | 0x0020 |
					     0x0001))]);
				GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 X2[(((((GFX.
										 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
							 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
													SubScreen
													[Offset +
													2 *
													x]) : GFX.
							   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
					 (((GFX.
					    ScreenColors[0])) & (((GFX.
							    SubZBuffer[Offset +
							    2 *
							    x]) & 0x20) ? (GFX.
							    SubScreen
							    [Offset
							    +
							    2 *
							    x]) :
					    GFX.
					    FixedColour) & (0x0400 | 0x0020 |
						    0x0001))]);
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16AddF1_2_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     x]))) & (GFX.
					     FixedColour) & (0x0400
						     |
						     0x0020
						     |
						     0x0001))])
					 : (((((((((GFX.ClipColors ? 0 : GFX.
														 SubScreen[Offset +
														 2 *
														 x]))) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
								 ((((GFX.ClipColors ? 0 : GFX.
								     SubScreen[Offset +
								     2 *
								     x]))) & (GFX.
							     FixedColour) & (0x0400 | 0x0020 |
								     0x0001))) |
							 0x0000)));
				GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.ScreenColors[0])) & (GFX.
							 FixedColour) &
						  (0x0400 | 0x0020 | 0x0001))])
					 : ((((((((GFX.
													 ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
										 ((GFX.
										   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) +
								 (((GFX.ScreenColors[0])) & (GFX.
									 FixedColour) & (0x0400 |
										 0x0020 |
										 0x0001))) |
							 0x0000)));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16AddS1_2_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     x]) & 0x20) ? (GFX.
								     RealScreenColors
								     [0]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 *
						     x]))) & (((GFX.
							     SubZBuffer[Offset +
							     2 *
							     x]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [0]) : GFX.
					     FixedColour) & (0x0400
						     |
						     0x0020
						     |
						     0x0001))])
						     : (((GFX.
										     SubZBuffer[Offset +
										     2 *
										     x]) & 0x20)
								     ? ((((((((GFX.ClipColors ? 0 : GFX.
																     SubScreen[Offset +
																     2 *
																     x]))) & (~(0x0400 | 0x0020 | 0x0001))) +
												     (((GFX.
													RealScreenColors[0])) & (~(0x0400 | 0x0020 |
														0x0001)))) >> 1) +
										     ((((GFX.ClipColors ? 0 : GFX.
											 SubScreen[Offset +
											 2 *
											 x]))) & ((GFX.
											 RealScreenColors[0])) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
									     | 0x0000) : GFX.
								     X2[((((((GFX.ClipColors ? 0 : GFX.
															     SubScreen[Offset +
															     2 *
															     x]))) & (~(0x0400 | 0x0020 | 0x0001))) +
											     ((GFX.
											       FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
								     +
								     ((((GFX.ClipColors ? 0 : GFX.
									 SubScreen[Offset +
									 2 *
									 x]))) & (GFX.
								 FixedColour) & (0x0400 | 0x0020 |
									 0x0001))]));
				GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors ? (GFX.
						 X2[(((((GFX.
											 ScreenColors[0])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.
								     SubZBuffer[Offset +
								     2 *
								     x]) & 0x20) ? (GFX.
								     SubScreen
								     [Offset +
								     2 *
								     x]) : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 |
										   0x0001)))) >> 1) +
						 (((GFX.
						    ScreenColors[0])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) &
							    0x20) ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
						    FixedColour) & (0x0400
							    |
							    0x0020
							    |
							    0x0001))])
							    : (((GFX.
											    SubZBuffer[Offset +
											    2 *
											    x]) & 0x20)
									    ? (((((((GFX.
																    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001)))
													    +
													    (((GFX.
													       SubScreen[Offset +
													       2 *
													       x])) & (~(0x0400 | 0x0020 | 0x0001)))) >>
												    1) +
											    (((GFX.ScreenColors[0])) & ((GFX.
													    SubScreen[Offset +
													    2 *
													    x])) & (0x0400 |
													    0x0020 |
													    0x0001)))
										    | 0x0000) : GFX.
									    X2[(((((GFX.
														    ScreenColors[0])) & (~(0x0400 | 0x0020 | 0x0001))) +
											    ((GFX.
											      FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1)
									    +
									    (((GFX.ScreenColors[0])) & (GFX.
										    FixedColour) & (0x0400 |
											    0x0020 |
											    0x0001))]));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16Sub_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(COLOR_SUB
					 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
					  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
						  RealScreenColors
						  [0]) : GFX.
					  FixedColour));
				GFX.S[Offset + 2 * x + 1] =
					(COLOR_SUB
					 ((GFX.ScreenColors[0]),
					  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
						  SubScreen[Offset
						  +
						  2 *
						  x]) :
					  GFX.FixedColour));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16SubF1_2_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  GFX.FixedColour)) : (GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  x]))) | ((0x4000 |
											  0x0200 |
											  0x0010)
										  << 1)) -
							  ((GFX.
							    FixedColour) & (~(0x0400 |
									    0x0020 |
									    0x0001))))
						  >> 1]));
				GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB ((GFX.ScreenColors[0]), GFX.FixedColour)) : (GFX.
						 ZERO[((((GFX.ScreenColors[0])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void DrawBackdrop16SubS1_2_Hires (uint32 Offset, uint32 Left, uint32 Right)
{

	register uint32 l, x;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	for (l = GFX.StartY; l <= GFX.EndY; l++, Offset += GFX.PPL)
	{
		for (x = Left; x < Right; x++)
			if (1 > GFX.DB[Offset + 2 * x])
			{
				GFX.S[Offset + 2 * x] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  RealScreenColors
							  [0]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  x]) & 0x20) ? GFX.
						  ZERO[(((((GFX.ClipColors ? 0 : GFX.
											  SubScreen[Offset +
											  2 *
											  x]))) | ((0x4000 |
											  0x0200 |
											  0x0010) <<
										  1)) -
							  (((GFX.
							     RealScreenColors[0])) & (~(0x0400
								     |
								     0x0020
								     |
								     0x0001))))
						  >> 1] :
						  COLOR_SUB (((GFX.ClipColors ? 0 : GFX.
									  SubScreen[Offset + 2 * x])),
							  GFX.FixedColour)));
				GFX.S[Offset + 2 * x + 1] =
					(GFX.
					 ClipColors
					 ? (COLOR_SUB
						 ((GFX.ScreenColors[0]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour)) : (((GFX.
								  SubZBuffer[Offset +
								  2 *
								  x]) & 0x20) ? GFX.
						  ZERO[((((GFX.
										  ScreenColors[0])) | ((0x4000 |
											  0x0200 |
											  0x0010) <<
										  1)) -
							  (((GFX.
							     SubScreen[Offset +
							     2 *
							     x])) & (~(0x0400 |
								     0x0020 |
								     0x0001)))) >>
						  1] : COLOR_SUB ((GFX.
								  ScreenColors[0]),
							  GFX.FixedColour)));
				GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] = 1;
			};
	};

}

static void (*Renderers_DrawBackdrop16Hires[7]) (uint32 Offset, uint32 Left, uint32 Right) =
{
	DrawBackdrop16_Hires,
	DrawBackdrop16Add_Hires,
	DrawBackdrop16AddF1_2_Hires,
	DrawBackdrop16AddS1_2_Hires,
	DrawBackdrop16Sub_Hires,
	DrawBackdrop16SubF1_2_Hires, DrawBackdrop16SubS1_2_Hires
};

extern struct SLineMatrixData LineMatrixData[240];

static void DrawMode7BG1_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		uint8 Pix;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset -
		CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Add_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line, Offset;
	int aa, cc, startx;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
													    SubScreen
													    [Offset +
													    x]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
													    SubScreen
													    [Offset +
													    x]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line, Offset;
	int aa, cc, startx;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy = (((VOffset - CentreY) & 0x2000) ? ((VOffset -
		CentreY) | ~0x3ff) : ((VOffset - CentreY) & 0x3ff));

		BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
		(CentreX << 8);

		DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
		(CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;

				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset,CentreX, CentreY;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff)
		: ((HOffset - CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);

		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Sub_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + x] = (D + 7);
				}
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;

				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + x] = (D + 7);
				}
			}
		}
	}
}

static void DrawMode7BG1SubF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1SubS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty, AA, BB, CC, DD;
		uint8 Pix;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  x]) : GFX.
							  FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     x])) & (~(0x0400
									     |
									     0x0020
									     |
									     0x0001))))
							  >> 1] : COLOR_SUB ((GFX.
									  ScreenColors
									  [Pix]),
								  GFX.
								  FixedColour)));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  x]) : GFX.
							  FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     x])) & (~(0x0400
									     |
									     0x0020
									     |
									     0x0001))))
							  >> 1] : COLOR_SUB ((GFX.
									  ScreenColors
									  [Pix]),
								  GFX.
								  FixedColour)));
					GFX.DB[Offset + x] = (D + 7);
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG1Normal1x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG1_Normal1x1,
	DrawMode7BG1Add_Normal1x1,
	DrawMode7BG1AddF1_2_Normal1x1,
	DrawMode7BG1AddS1_2_Normal1x1,
	DrawMode7BG1Sub_Normal1x1,
	DrawMode7BG1SubF1_2_Normal1x1, DrawMode7BG1SubS1_2_Normal1x1
};

static void DrawMode7BG1_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty, AA, BB, CC, DD;
		uint8 Pix;
		int32 HOffset, VOffset, CentreX, CentreY;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Add_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty, AA, BB, CC, DD;
		uint8 Pix;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	uint32 x, Line, Offset;
	struct SLineMatrixData *l;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);

		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		uint8 Pix;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData,b;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Sub_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;

	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 *TileData, b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1SubF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);
				if (((X | Y) & ~0x3ff) == 0)
				{
					TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;

				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1SubS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);
				uint8 *TileData, b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG1Normal2x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG1_Normal2x1,
	DrawMode7BG1Add_Normal2x1,
	DrawMode7BG1AddF1_2_Normal2x1,
	DrawMode7BG1AddS1_2_Normal2x1,
	DrawMode7BG1Sub_Normal2x1,
	DrawMode7BG1SubF1_2_Normal2x1, DrawMode7BG1SubS1_2_Normal2x1
};

static void DrawMode7BG1_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;
	VRAM1 = Memory.VRAM + 1;

	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]));
					GFX.S[Offset + 2 * x + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);
				if (((X | Y) & ~0x3ff) == 0)
				{
					TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]));
					GFX.S[Offset + 2 * x + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Add_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;
		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 | 0x0001)))
								 +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * x]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     x]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 | 0x0001)))
								 +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * x]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     x]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddF1_2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 x]))) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     x]))) & (GFX.
								     FixedColour) & (0x0400 |
									     0x0020 |
									     0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 x]))) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     x]))) & (GFX.
								     FixedColour) & (0x0400 |
									     0x0020 |
									     0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1AddS1_2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (((GFX.
								     SubZBuffer
								     [Offset +
								     2 *
								     x]) & 0x20)
						     ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (((GFX.
								     SubZBuffer
								     [Offset +
								     2 *
								     x]) & 0x20)
						     ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1Sub_Hires (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx;
	struct SLineMatrixData *l;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour));
					GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour));
					GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1SubF1_2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;

	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400
										    |
										    0x0020
										    |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400
										    |
										    0x0020
										    |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void DrawMode7BG1SubS1_2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx;
	uint32 x, Line, Offset;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     RealScreenColors[Pix]))
								   &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 :
										  GFX.
										  SubScreen[Offset +
										  2 * x])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + 7) > GFX.DB[Offset + 2 * x] && (Pix = (b & 0xff)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     RealScreenColors[Pix]))
								   &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 :
										  GFX.
										  SubScreen[Offset +
										  2 * x])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + 7);
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG1Hires[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG1_Hires,
	DrawMode7BG1Add_Hires,
	DrawMode7BG1AddF1_2_Hires,
	DrawMode7BG1AddS1_2_Hires,
	DrawMode7BG1Sub_Hires,
	DrawMode7BG1SubF1_2_Hires, DrawMode7BG1SubS1_2_Hires
};

static void DrawMode7MosaicBG1_Normal1x1 (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	uint32 Line, Offset;
	int32 h, w, x, MLeft, MRight;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	StartY = GFX.StartY;

	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;
	MLeft = Left;
	MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Add_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     + w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset + w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset + w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     + w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset + w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset + w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset + w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset + w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) &
										  (((GFX.
										     SubZBuffer[Offset + w +
										     h *
										     GFX.
										     PPL]) & 0x20)
										   ? (GFX.
											   SubScreen[Offset + w +
											   h *
											   GFX.
											   PPL]) : GFX.
										   FixedColour) & (0x0400 |
											   0x0020 |
											   0x0001))])
											   : (((GFX.
															   SubZBuffer[Offset + w +
															   h *
															   GFX.
															   PPL]) & 0x20)
													   ? (((((((GFX.
																				   ScreenColors[Pix])) & (~(0x0400 |
																					   0x0020 |
																					   0x0001)))
																	   +
																	   (((GFX.
																	      SubScreen[Offset + w +
																	      h *
																	      GFX.
																	      PPL])) & (~(0x0400 |
																		      0x0020 |
																		      0x0001)))) >>
																   1) +
															   (((GFX.ScreenColors[Pix])) & ((GFX.
																	   SubScreen
																	   [Offset +
																	   w +
																	   h *
																	   GFX.
																	   PPL])) &
															    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
															    : GFX.
															    X2[(((((GFX.
																					    ScreenColors[Pix])) & (~(0x0400 |
																						    0x0020 |
																						    0x0001))) +
																		    ((GFX.
																		      FixedColour) & (~(0x0400 | 0x0020 |
																				      0x0001)))) >> 1) +
															    (((GFX.ScreenColors[Pix])) & (GFX.
																    FixedColour)
															     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset + w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset + w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) &
										  (((GFX.
										     SubZBuffer[Offset + w +
										     h *
										     GFX.
										     PPL]) & 0x20)
										   ? (GFX.
											   SubScreen[Offset + w +
											   h *
											   GFX.
											   PPL]) : GFX.
										   FixedColour) & (0x0400 |
											   0x0020 |
											   0x0001))])
											   : (((GFX.
															   SubZBuffer[Offset + w +
															   h *
															   GFX.
															   PPL]) & 0x20)
													   ? (((((((GFX.
																				   ScreenColors[Pix])) & (~(0x0400 |
																					   0x0020 |
																					   0x0001)))
																	   +
																	   (((GFX.
																	      SubScreen[Offset + w +
																	      h *
																	      GFX.
																	      PPL])) & (~(0x0400 |
																		      0x0020 |
																		      0x0001)))) >>
																   1) +
															   (((GFX.ScreenColors[Pix])) & ((GFX.
																	   SubScreen
																	   [Offset +
																	   w +
																	   h *
																	   GFX.
																	   PPL])) &
															    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
															    : GFX.
															    X2[(((((GFX.
																					    ScreenColors[Pix])) & (~(0x0400 |
																						    0x0020 |
																						    0x0001))) +
																		    ((GFX.
																		      FixedColour) & (~(0x0400 | 0x0020 |
																				      0x0001)))) >> 1) +
															    (((GFX.ScreenColors[Pix])) & (GFX.
																    FixedColour)
															     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Sub_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset + w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset + w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + w + h * GFX.PPL] = (D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void (*Renderers_DrawMode7MosaicBG1Normal1x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7MosaicBG1_Normal1x1,
	DrawMode7MosaicBG1Add_Normal1x1,
	DrawMode7MosaicBG1AddF1_2_Normal1x1,
	DrawMode7MosaicBG1AddS1_2_Normal1x1,
	DrawMode7MosaicBG1Sub_Normal1x1,
	DrawMode7MosaicBG1SubF1_2_Normal1x1, DrawMode7MosaicBG1SubS1_2_Normal1x1
};

static void DrawMode7MosaicBG1_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Add_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Sub_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void (*Renderers_DrawMode7MosaicBG1Normal2x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7MosaicBG1_Normal2x1,
	DrawMode7MosaicBG1Add_Normal2x1,
	DrawMode7MosaicBG1AddF1_2_Normal2x1,
	DrawMode7MosaicBG1AddS1_2_Normal2x1,
	DrawMode7MosaicBG1Sub_Normal2x1,
	DrawMode7MosaicBG1SubF1_2_Normal2x1, DrawMode7MosaicBG1SubS1_2_Normal2x1
};

static void DrawMode7MosaicBG1_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	uint32 Line,Offset;
	int32 h, w, x, MLeft, MRight;
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	StartY = GFX.StartY;

	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;

	MLeft = Left;
	MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		uint8 Pix, ctr;
		int32 HOffset, VOffset, CentreX, CentreY;

		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									((GFX.ClipColors ? 0 : GFX.
									  SubScreen[Offset + 2 * w + h * GFX.PPL]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									((GFX.ClipColors ? 0 : GFX.
									  SubScreen[Offset + 2 * w + h * GFX.PPL]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Add_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	uint32 Line, Offset;
	int32 h, w, x, MLeft, MRight;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	StartY = GFX.StartY;

	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;

	MLeft = Left;
	MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 X2[((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset + 2 * w +
															 h *
															 GFX.
															 PPL]))) & (~(0x0400 | 0x0020
															 | 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     RealScreenColors
											     [Pix])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset + 2 * w +
									     h *
									     GFX.PPL]))) & (((GFX.
										     SubZBuffer
										     [Offset +
										     2 * w +
										     h *
										     GFX.
										     PPL]) &
									     0x20) ? (GFX.
										     RealScreenColors
										     [Pix])
								     : GFX.
								     FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 X2[((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset + 2 * w +
															 h *
															 GFX.
															 PPL]))) & (~(0x0400 | 0x0020
															 | 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     RealScreenColors
											     [Pix])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset + 2 * w +
									     h *
									     GFX.PPL]))) & (((GFX.
										     SubZBuffer
										     [Offset +
										     2 * w +
										     h *
										     GFX.
										     PPL]) &
									     0x20) ? (GFX.
										     RealScreenColors
										     [Pix])
								     : GFX.
								     FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddF1_2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	uint32 Line, Offset;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset + 2 * w +
										     h *
										     GFX.
										     PPL]))) & (GFX.
									     FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
											  : (((((((((GFX.ClipColors ? 0 : GFX.
																					  SubScreen[Offset + 2 * w +
																					  h *
																					  GFX.
																					  PPL]))) & (~(0x0400 |
																					  0x0020 |
																					  0x0001))) +
																	  ((GFX.
																	    FixedColour) & (~(0x0400 | 0x0020 |
																			    0x0001)))) >> 1) +
															  ((((GFX.ClipColors ? 0 : GFX.
															      SubScreen[Offset + 2 * w +
															      h *
															      GFX.PPL]))) & (GFX.
														      FixedColour)
															   & (0x0400 | 0x0020 | 0x0001))) |
														  0x0000)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset + 2 * w +
										     h *
										     GFX.
										     PPL]))) & (GFX.
									     FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
											  : (((((((((GFX.ClipColors ? 0 : GFX.
																					  SubScreen[Offset + 2 * w +
																					  h *
																					  GFX.
																					  PPL]))) & (~(0x0400 |
																					  0x0020 |
																					  0x0001))) +
																	  ((GFX.
																	    FixedColour) & (~(0x0400 | 0x0020 |
																			    0x0001)))) >> 1) +
															  ((((GFX.ClipColors ? 0 : GFX.
															      SubScreen[Offset + 2 * w +
															      h *
															      GFX.PPL]))) & (GFX.
														      FixedColour)
															   & (0x0400 | 0x0020 | 0x0001))) |
														  0x0000)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1AddS1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   RealScreenColors[Pix])
												   : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
														   >> 1) +
														   ((((GFX.ClipColors ? 0 : GFX.
														       SubScreen[Offset + 2 * w +
														       h *
														       GFX.
														       PPL]))) &
														    (((GFX.
														       SubZBuffer[Offset +
														       2 * w +
														       h *
														       GFX.
														       PPL]) & 0x20)
														     ? (GFX.
															     RealScreenColors[Pix]) :
														     GFX.
														     FixedColour) & (0x0400 |
															     0x0020 |
															     0x0001))])
															     : (((GFX.
																			     SubZBuffer[Offset + 2 * w +
																			     h *
																			     GFX.
																			     PPL]) & 0x20)
																	     ? ((((((((GFX.ClipColors ? 0 : GFX.
																									     SubScreen[Offset + 2 * w +
																									     h *
																									     GFX.
																									     PPL]))) & (~(0x0400 |
																									     0x0020 |
																									     0x0001))) +
																					     (((GFX.
																						RealScreenColors[Pix])) & (~(0x0400
																							|
																							0x0020
																							|
																							0x0001))))
																				     >> 1) +
																			     ((((GFX.ClipColors ? 0 : GFX.
																				 SubScreen[Offset + 2 * w +
																				 h *
																				 GFX.PPL]))) & ((GFX.
																				 RealScreenColors
																				 [Pix])) &
																			      (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																			      : GFX.
																			      X2[((((((GFX.ClipColors ? 0 : GFX.
																										      SubScreen[Offset + 2 * w +
																										      h *
																										      GFX.
																										      PPL]))) & (~(0x0400 |
																										      0x0020 |
																										      0x0001))) +
																						      ((GFX.
																							FixedColour) & (~(0x0400 | 0x0020 |
																									0x0001)))) >> 1) +
																			      ((((GFX.ClipColors ? 0 : GFX.
																				  SubScreen[Offset + 2 * w +
																				  h *
																				  GFX.PPL]))) & (GFX.
																			  FixedColour)
																			       & (0x0400 | 0x0020 | 0x0001))]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   RealScreenColors[Pix])
												   : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
														   >> 1) +
														   ((((GFX.ClipColors ? 0 : GFX.
														       SubScreen[Offset + 2 * w +
														       h *
														       GFX.
														       PPL]))) &
														    (((GFX.
														       SubZBuffer[Offset +
														       2 * w +
														       h *
														       GFX.
														       PPL]) & 0x20)
														     ? (GFX.
															     RealScreenColors[Pix]) :
														     GFX.
														     FixedColour) & (0x0400 |
															     0x0020 |
															     0x0001))])
															     : (((GFX.
																			     SubZBuffer[Offset + 2 * w +
																			     h *
																			     GFX.
																			     PPL]) & 0x20)
																	     ? ((((((((GFX.ClipColors ? 0 : GFX.
																									     SubScreen[Offset + 2 * w +
																									     h *
																									     GFX.
																									     PPL]))) & (~(0x0400 |
																									     0x0020 |
																									     0x0001))) +
																					     (((GFX.
																						RealScreenColors[Pix])) & (~(0x0400
																							|
																							0x0020
																							|
																							0x0001))))
																				     >> 1) +
																			     ((((GFX.ClipColors ? 0 : GFX.
																				 SubScreen[Offset + 2 * w +
																				 h *
																				 GFX.PPL]))) & ((GFX.
																				 RealScreenColors
																				 [Pix])) &
																			      (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																			      : GFX.
																			      X2[((((((GFX.ClipColors ? 0 : GFX.
																										      SubScreen[Offset + 2 * w +
																										      h *
																										      GFX.
																										      PPL]))) & (~(0x0400 |
																										      0x0020 |
																										      0x0001))) +
																						      ((GFX.
																							FixedColour) & (~(0x0400 | 0x0020 |
																									0x0001)))) >> 1) +
																			      ((((GFX.ClipColors ? 0 : GFX.
																				  SubScreen[Offset + 2 * w +
																				  h *
																				  GFX.PPL]))) & (GFX.
																			  FixedColour)
																			       & (0x0400 | 0x0020 | 0x0001))]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1Sub_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(COLOR_SUB
									 (((GFX.ClipColors ? 0 : GFX.
									    SubScreen[Offset + 2 * w + h * GFX.PPL])),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    RealScreenColors
									    [Pix]) :
									  GFX.FixedColour));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(COLOR_SUB
									 (((GFX.ClipColors ? 0 : GFX.
									    SubScreen[Offset + 2 * w + h * GFX.PPL])),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    RealScreenColors
									    [Pix]) :
									  GFX.FixedColour));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubF1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 (((GFX.ClipColors ? 0 : GFX.
										    SubScreen[Offset + 2 * w +
										    h * GFX.PPL])),
										  GFX.FixedColour)) : (GFX.
										  ZERO[(((((GFX.
															  ClipColors ?
															  0 : GFX.
															  SubScreen
															  [Offset +
															  2 * w +
															  h *
															  GFX.
															  PPL]))) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 (((GFX.ClipColors ? 0 : GFX.
										    SubScreen[Offset + 2 * w +
										    h * GFX.PPL])),
										  GFX.FixedColour)) : (GFX.
										  ZERO[(((((GFX.
															  ClipColors ?
															  0 : GFX.
															  SubScreen
															  [Offset +
															  2 * w +
															  h *
															  GFX.
															  PPL]))) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG1SubS1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	if ((Memory.FillRAM[0x2130] & 1))
	{
		if (IPPU.DirectColourMapsNeedRebuild)
			S9xBuildDirectColourMaps ();
		GFX.RealScreenColors = DirectColourMaps[0];
	}
	else
		GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[0])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 (((GFX.ClipColors ? 0 : GFX.
										    SubScreen[Offset + 2 * w +
										    h * GFX.PPL])),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    RealScreenColors
										    [Pix]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[(((((GFX.
															  ClipColors ?
															  0 : GFX.
															  SubScreen
															  [Offset +
															  2 * w +
															  h *
															  GFX.
															  PPL]))) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     RealScreenColors
											     [Pix])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB (((GFX.
														  ClipColors
														  ? 0 :
														  GFX.
														  SubScreen
														  [Offset +
														  2 * w +
														  h *
														  GFX.
														  PPL])),
												  GFX.
												  FixedColour)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0xff)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + 7) > GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 (((GFX.ClipColors ? 0 : GFX.
										    SubScreen[Offset + 2 * w +
										    h * GFX.PPL])),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    RealScreenColors
										    [Pix]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[(((((GFX.
															  ClipColors ?
															  0 : GFX.
															  SubScreen
															  [Offset +
															  2 * w +
															  h *
															  GFX.
															  PPL]))) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     RealScreenColors
											     [Pix])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB (((GFX.
														  ClipColors
														  ? 0 :
														  GFX.
														  SubScreen
														  [Offset +
														  2 * w +
														  h *
														  GFX.
														  PPL])),
												  GFX.
												  FixedColour)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + 7);
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void (*Renderers_DrawMode7MosaicBG1Hires[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7MosaicBG1_Hires,
	DrawMode7MosaicBG1Add_Hires,
	DrawMode7MosaicBG1AddF1_2_Hires,
	DrawMode7MosaicBG1AddS1_2_Hires,
	DrawMode7MosaicBG1Sub_Hires,
	DrawMode7MosaicBG1SubF1_2_Hires,
	DrawMode7MosaicBG1SubS1_2_Hires
};

static void DrawMode7BG2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Add_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
													    SubScreen
													    [Offset +
													    x]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
													    SubScreen
													    [Offset +
													    x]) :
								   GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Sub_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  x]) : GFX.
							  FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     x])) & (~(0x0400
									     |
									     0x0020
									     |
									     0x0001))))
							  >> 1] : COLOR_SUB ((GFX.
									  ScreenColors
									  [Pix]),
								  GFX.
								  FixedColour)));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset +
								  x]) : GFX.
							  FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 | 0x0010)
									   << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     x])) & (~(0x0400
									     |
									     0x0020
									     |
									     0x0001))))
							  >> 1] : COLOR_SUB ((GFX.
									  ScreenColors
									  [Pix]),
								  GFX.
								  FixedColour)));
					GFX.DB[Offset + x] = (D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG2Normal1x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG2_Normal1x1,
	DrawMode7BG2Add_Normal1x1,
	DrawMode7BG2AddF1_2_Normal1x1,
	DrawMode7BG2AddS1_2_Normal1x1,
	DrawMode7BG2Sub_Normal1x1,
	DrawMode7BG2SubF1_2_Normal1x1, DrawMode7BG2SubS1_2_Normal1x1
};

static void DrawMode7BG2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Add_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Sub_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] = GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG2Normal2x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG2_Normal2x1,
	DrawMode7BG2Add_Normal2x1,
	DrawMode7BG2AddF1_2_Normal2x1,
	DrawMode7BG2AddS1_2_Normal2x1,
	DrawMode7BG2Sub_Normal2x1,
	DrawMode7BG2SubF1_2_Normal2x1,
	DrawMode7BG2SubS1_2_Normal2x1
};

static void DrawMode7BG2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]));
					GFX.S[Offset + 2 * x + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]));
					GFX.S[Offset + 2 * x + 1] = (GFX.ScreenColors[Pix]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Add_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	uint32 x, Line, Offset;
	int aa, cc, startx, starty;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	Offset = GFX.StartY * GFX.PPL;
	l = &LineMatrixData[GFX.StartY];

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int32 HOffset, VOffset, CentreX, CentreY;
		int AA, BB, CC, DD, xx, yy;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy = (((VOffset - CentreY) & 0x2000) ? ((VOffset -
		CentreY) | ~0x3ff) : ((VOffset - CentreY) & 0x3ff));

		BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
		(CentreX << 8);
		DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
		(CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}

		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset -
		CentreX) | ~0x3ff) : ((HOffset - CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 | 0x0001)))
								 +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * x]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     x]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 X2[((((((GFX.ClipColors ? 0 : GFX.
												 SubScreen[Offset +
												 2 *
												 x]))) & (~(0x0400 | 0x0020 | 0x0001)))
								 +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														RealScreenColors
														[Pix])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 ((((GFX.ClipColors ? 0 : GFX.
						     SubScreen[Offset +
						     2 * x]))) & (((GFX.SubZBuffer[Offset +
							     2 *
							     x]) &
						     0x20) ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
					     FixedColour) & (0x0400 |
						     0x0020 |
						     0x0001))]);
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 X2[(((((GFX.
											 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
												 0x0001))) +
								 ((((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
														SubScreen
														[Offset
														+
														2 *
														x])
								   : GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >>
							 1) +
						 (((GFX.
						    ScreenColors[Pix])) & (((GFX.
								    SubZBuffer[Offset +
								    2 *
								    x]) & 0x20)
						    ? (GFX.
							    SubScreen[Offset +
							    2 *
							    x]) : GFX.
						    FixedColour) & (0x0400 |
							    0x0020 |
							    0x0001))]);
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddF1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset -
		CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 x]))) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     x]))) & (GFX.
								     FixedColour) & (0x0400 |
									     0x0020 |
									     0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;

				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))])
						 : (((((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset +
															 2 *
															 x]))) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset +
									     2 *
									     x]))) & (GFX.
								     FixedColour) & (0x0400 |
									     0x0020 |
									     0x0001))) |
								 0x0000)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.ScreenColors[Pix])) & (GFX.
								 FixedColour)
							  & (0x0400 | 0x0020 | 0x0001))])
						 : ((((((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 | 0x0020 |
															 0x0001))) +
											 ((GFX.
											   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
										 >> 1) +
									 (((GFX.ScreenColors[Pix])) & (GFX.
										 FixedColour) & (0x0400
											 |
											 0x0020
											 |
											 0x0001)))
								 | 0x0000)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2AddS1_2_Hires (uint32 Left, uint32 Right, int D)
{
	uint32 x, Line, Offset;
	int aa, cc, startx;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	Offset = GFX.StartY * GFX.PPL;

	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		uint8 Pix;

		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
		(CentreX << 8);
		DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
		(CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}

		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : 
		((HOffset - CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);

		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (((GFX.
								     SubZBuffer
								     [Offset +
								     2 *
								     x]) & 0x20)
						     ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;

				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[((((((GFX.ClipColors ? 0 : GFX.
													 SubScreen[Offset +
													 2 *
													 x]))) & (~(0x0400 |
													 0x0020 |
													 0x0001))) +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     RealScreenColors
									     [Pix]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 ((((GFX.ClipColors ? 0 : GFX.
							     SubScreen[Offset +
							     2 *
							     x]))) & (((GFX.
								     SubZBuffer
								     [Offset +
								     2 *
								     x]) & 0x20)
						     ? (GFX.
							     RealScreenColors
							     [Pix]) : GFX.
						     FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? ((((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & ((GFX.RealScreenColors[Pix])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[((((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + ((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x]))) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors ? (GFX.
							 X2[(((((GFX.
												 ScreenColors[Pix])) & (~(0x0400 |
													 0x0020 |
													 0x0001)))
									 +
									 ((((GFX.
									     SubZBuffer[Offset +
									     2 *
									     x]) & 0x20) ? (GFX.
									     SubScreen
									     [Offset
									     +
									     2 *
									     x]) :
									   GFX.
									   FixedColour) & (~(0x0400 | 0x0020 |
											   0x0001)))) >> 1) +
							 (((GFX.
							    ScreenColors[Pix])) & (((GFX.
									    SubZBuffer
									    [Offset +
									    2 *
									    x]) & 0x20)
							    ? (GFX.
								    SubScreen
								    [Offset +
								    2 *
								    x]) : GFX.
							    FixedColour) &
							  (0x0400 | 0x0020 | 0x0001))]) : (((GFX.
									  SubZBuffer
									  [Offset
									  +
									  2 *
									  x])
								  &
								  0x20)
							  ? (((((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + (((GFX.SubScreen[Offset + 2 * x])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & ((GFX.SubScreen[Offset + 2 * x])) & (0x0400 | 0x0020 | 0x0001))) | 0x0000) : GFX.X2[(((((GFX.ScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001))) + ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1) + (((GFX.ScreenColors[Pix])) & (GFX.FixedColour) & (0x0400 | 0x0020 | 0x0001))]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2Sub_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour));
					GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(COLOR_SUB
						 (((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * x])),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  RealScreenColors
							  [Pix]) :
						  GFX.FixedColour));
					GFX.S[Offset + 2 * x + 1] =
						(COLOR_SUB
						 ((GFX.ScreenColors[Pix]),
						  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
							  SubScreen
							  [Offset +
							  2 *
							  x]) : GFX.
						  FixedColour));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubF1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400
										    |
										    0x0020
										    |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  GFX.FixedColour)) : (GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  ((GFX.
								    FixedColour) & (~(0x0400
										    |
										    0x0020
										    |
										    0x0001))))
							  >> 1]));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB ((GFX.ScreenColors[Pix]), GFX.FixedColour))
						 : (GFX.
							 ZERO[((((GFX.
											 ScreenColors[Pix])) | ((0x4000 | 0x0200 |
												 0x0010) << 1)) -
								 ((GFX.
								   FixedColour) & (~(0x0400 | 0x0020 | 0x0001))))
							 >> 1]));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void DrawMode7BG2SubS1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 x, Line;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx;
	uint32 Offset = GFX.StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[GFX.StartY];
	for (Line = GFX.StartY; Line <= GFX.EndY; Line++, Offset += GFX.PPL, l++)
	{
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = Right - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = Left;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		if (!PPU.Mode7Repeat)
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     RealScreenColors[Pix]))
								   &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 :
										  GFX.
										  SubScreen[Offset +
										  2 * x])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
		else
		{
			for (x = Left; x < Right; x++, AA += aa, CC += cc)
			{
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * x]
						&& (Pix = (b & 0x7f)))
				{
					GFX.S[Offset + 2 * x] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 (((GFX.ClipColors ? 0 : GFX.
							    SubScreen[Offset + 2 * x])),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  RealScreenColors
								  [Pix]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[(((((GFX.
												  ClipColors ? 0 : GFX.
												  SubScreen[Offset +
												  2 *
												  x]))) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     RealScreenColors[Pix]))
								   &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB (((GFX.
										  ClipColors ? 0 :
										  GFX.
										  SubScreen[Offset +
										  2 * x])),
								  GFX.FixedColour)));
					GFX.S[Offset + 2 * x + 1] =
						(GFX.
						 ClipColors
						 ? (COLOR_SUB
							 ((GFX.ScreenColors[Pix]),
							  ((GFX.SubZBuffer[Offset + 2 * x]) & 0x20) ? (GFX.
								  SubScreen
								  [Offset
								  +
								  2 *
								  x]) :
							  GFX.FixedColour)) : (((GFX.
									  SubZBuffer[Offset +
									  2 *
									  x]) & 0x20) ? GFX.
							  ZERO[((((GFX.
											  ScreenColors[Pix])) |
									  ((0x4000 | 0x0200 |
									    0x0010) << 1)) -
								  (((GFX.
								     SubScreen[Offset +
								     2 *
								     x])) &
								   (~
								    (0x0400 | 0x0020 |
								     0x0001)))) >> 1] :
							  COLOR_SUB ((GFX.
									  ScreenColors[Pix]),
								  GFX.FixedColour)));
					GFX.DB[Offset + 2 * x] = GFX.DB[Offset + 2 * x + 1] =
						(D + ((b & 0x80) ? 11 : 3));
				};
			}
		}
	};

}

static void (*Renderers_DrawMode7BG2Hires[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7BG2_Hires,
	DrawMode7BG2Add_Hires,
	DrawMode7BG2AddF1_2_Hires,
	DrawMode7BG2AddS1_2_Hires,
	DrawMode7BG2Sub_Hires,
	DrawMode7BG2SubF1_2_Hires, DrawMode7BG2SubS1_2_Hires
};

static void DrawMode7MosaicBG2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Add_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     + w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset + w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset + w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     + w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset + w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset + w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset + w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset + w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) &
										  (((GFX.
										     SubZBuffer[Offset + w +
										     h *
										     GFX.
										     PPL]) & 0x20)
										   ? (GFX.
											   SubScreen[Offset + w +
											   h *
											   GFX.
											   PPL]) : GFX.
										   FixedColour) & (0x0400 |
											   0x0020 |
											   0x0001))])
											   : (((GFX.
															   SubZBuffer[Offset + w +
															   h *
															   GFX.
															   PPL]) & 0x20)
													   ? (((((((GFX.
																				   ScreenColors[Pix])) & (~(0x0400 |
																					   0x0020 |
																					   0x0001)))
																	   +
																	   (((GFX.
																	      SubScreen[Offset + w +
																	      h *
																	      GFX.
																	      PPL])) & (~(0x0400 |
																		      0x0020 |
																		      0x0001)))) >>
																   1) +
															   (((GFX.ScreenColors[Pix])) & ((GFX.
																	   SubScreen
																	   [Offset +
																	   w +
																	   h *
																	   GFX.
																	   PPL])) &
															    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
															    : GFX.
															    X2[(((((GFX.
																					    ScreenColors[Pix])) & (~(0x0400 |
																						    0x0020 |
																						    0x0001))) +
																		    ((GFX.
																		      FixedColour) & (~(0x0400 | 0x0020 |
																				      0x0001)))) >> 1) +
															    (((GFX.ScreenColors[Pix])) & (GFX.
																    FixedColour)
															     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset + w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset + w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) &
										  (((GFX.
										     SubZBuffer[Offset + w +
										     h *
										     GFX.
										     PPL]) & 0x20)
										   ? (GFX.
											   SubScreen[Offset + w +
											   h *
											   GFX.
											   PPL]) : GFX.
										   FixedColour) & (0x0400 |
											   0x0020 |
											   0x0001))])
											   : (((GFX.
															   SubZBuffer[Offset + w +
															   h *
															   GFX.
															   PPL]) & 0x20)
													   ? (((((((GFX.
																				   ScreenColors[Pix])) & (~(0x0400 |
																					   0x0020 |
																					   0x0001)))
																	   +
																	   (((GFX.
																	      SubScreen[Offset + w +
																	      h *
																	      GFX.
																	      PPL])) & (~(0x0400 |
																		      0x0020 |
																		      0x0001)))) >>
																   1) +
															   (((GFX.ScreenColors[Pix])) & ((GFX.
																	   SubScreen
																	   [Offset +
																	   w +
																	   h *
																	   GFX.
																	   PPL])) &
															    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
															    : GFX.
															    X2[(((((GFX.
																					    ScreenColors[Pix])) & (~(0x0400 |
																						    0x0020 |
																						    0x0001))) +
																		    ((GFX.
																		      FixedColour) & (~(0x0400 | 0x0020 |
																				      0x0001)))) >> 1) +
															    (((GFX.ScreenColors[Pix])) & (GFX.
																    FixedColour)
															     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Sub_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2SubF1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2SubS1_2_Normal1x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset + w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + w + h * GFX.PPL] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset + w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + w + h * GFX.PPL] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void (*Renderers_DrawMode7MosaicBG2Normal1x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7MosaicBG2_Normal1x1,
	DrawMode7MosaicBG2Add_Normal1x1,
	DrawMode7MosaicBG2AddF1_2_Normal1x1,
	DrawMode7MosaicBG2AddS1_2_Normal1x1,
	DrawMode7MosaicBG2Sub_Normal1x1,
	DrawMode7MosaicBG2SubF1_2_Normal1x1, DrawMode7MosaicBG2SubS1_2_Normal1x1
};

static void DrawMode7MosaicBG2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Add_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Sub_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(COLOR_SUB
									 ((GFX.ScreenColors[Pix]),
									  ((GFX.
									    SubZBuffer[Offset + 2 * w +
									    h *
									    GFX.PPL]) & 0x20) ? (GFX.
									    SubScreen
									    [Offset +
									    2 * w +
									    h *
									    GFX.
									    PPL]) :
									  GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2SubF1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  GFX.FixedColour)) : (GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  ((GFX.
											    FixedColour) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2SubS1_2_Normal2x1 (uint32 Left, uint32 Right, int D)
{
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	struct SLineMatrixData *l;
	uint32 Line, Offset;
	int32 h, w, x, MLeft, MRight;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;

	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	StartY = GFX.StartY;
	
	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;

	MLeft = Left;
	MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors
									 ? (COLOR_SUB
										 ((GFX.ScreenColors[Pix]),
										  ((GFX.
										    SubZBuffer[Offset + 2 * w +
										    h *
										    GFX.PPL]) & 0x20) ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) :
										  GFX.FixedColour)) : (((GFX.
												  SubZBuffer[Offset +
												  2 * w +
												  h *
												  GFX.
												  PPL]) &
											  0x20) ? GFX.
										  ZERO[((((GFX.
														  ScreenColors
														  [Pix])) |
												  ((0x4000 |
												    0x0200 |
												    0x0010) <<
												   1)) -
											  (((GFX.
											     SubScreen
											     [Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL])) &
											   (~
											    (0x0400 |
											     0x0020 |
											     0x0001)))) >>
										  1] :
										  COLOR_SUB ((GFX.
													  ScreenColors
													  [Pix]),
												  GFX.
												  FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void (*Renderers_DrawMode7MosaicBG2Normal2x1[7]) (uint32 Left, uint32 Right, int D) =
{
	DrawMode7MosaicBG2_Normal2x1,
	DrawMode7MosaicBG2Add_Normal2x1,
	DrawMode7MosaicBG2AddF1_2_Normal2x1,
	DrawMode7MosaicBG2AddS1_2_Normal2x1,
	DrawMode7MosaicBG2Sub_Normal2x1,
	DrawMode7MosaicBG2SubF1_2_Normal2x1,
	DrawMode7MosaicBG2SubS1_2_Normal2x1
};

static void DrawMode7MosaicBG2_Hires (uint32 Left, uint32 Right, int D)
{
	struct SLineMatrixData *l;
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	uint32 Line, Offset;
	int32 h, w, x, MLeft, MRight;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;

	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;

	MLeft = Left;
	MRight = Right;

	StartY = GFX.StartY;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		int xx, yy, starty, AA, BB, CC, DD;

		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;

		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) + (CentreX << 8);
		DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) + (CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}

		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : 
		((HOffset - CentreX) & 0x3ff));
		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				if (--ctr)
					continue;
				ctr = HMosaic;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									((GFX.ClipColors ? 0 : GFX.
									  SubScreen[Offset + 2 * w + h * GFX.PPL]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;

				if (--ctr)
					continue;

				ctr = HMosaic;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									((GFX.ClipColors ? 0 : GFX.
									  SubScreen[Offset + 2 * w + h * GFX.PPL]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.ScreenColors[Pix]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Add_Hires (uint32 Left, uint32 Right, int D)
{

	struct SLineMatrixData *l;
	int aa, cc, startx, StartY, HMosaic, VMosaic, MosaicStart;
	uint32 Line, Offset;
	int32 h, w, x, MLeft, MRight;
	uint8 *VRAM1;

	VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	
	HMosaic = 1;
	VMosaic = 1;
	MosaicStart = 0;

	MLeft = Left;
	MRight = Right;

	StartY = GFX.StartY;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	Offset = StartY * GFX.PPL;
	l = &LineMatrixData[StartY];

	for (Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		int xx, yy, starty, AA, BB, CC, DD;
		int32 HOffset, VOffset, CentreX, CentreY;
		uint8 Pix, ctr;

		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;

		HOffset = ((int32) l->M7HOFS << 19) >> 19;
		VOffset = ((int32) l->M7VOFS << 19) >> 19;
		CentreX = ((int32) l->CentreX << 19) >> 19;
		CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) + (CentreX << 8);
		DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) + (CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset -
		CentreX) & 0x3ff));

		AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);

		ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 *TileData, b;

				if (--ctr)
					continue;

				ctr = HMosaic;
				X = ((AA + BB) >> 8) & 0x3ff;
				Y = ((CC + DD) >> 8) & 0x3ff;
				TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 X2[((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset + 2 * w +
															 h *
															 GFX.
															 PPL]))) & (~(0x0400 | 0x0020
															 | 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     RealScreenColors
											     [Pix])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset + 2 * w +
									     h *
									     GFX.PPL]))) & (((GFX.
										     SubZBuffer
										     [Offset +
										     2 * w +
										     h *
										     GFX.
										     PPL]) &
									     0x20) ? (GFX.
										     RealScreenColors
										     [Pix])
								     : GFX.
								     FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				int X, Y;
				uint8 b;

				if (--ctr)
					continue;

				ctr = HMosaic;
				X = ((AA + BB) >> 8);
				Y = ((CC + DD) >> 8);

				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 X2[((((((GFX.ClipColors ? 0 : GFX.
															 SubScreen[Offset + 2 * w +
															 h *
															 GFX.
															 PPL]))) & (~(0x0400 | 0x0020
															 | 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     RealScreenColors
											     [Pix])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 ((((GFX.ClipColors ? 0 : GFX.
									     SubScreen[Offset + 2 * w +
									     h *
									     GFX.PPL]))) & (((GFX.
										     SubZBuffer
										     [Offset +
										     2 * w +
										     h *
										     GFX.
										     PPL]) &
									     0x20) ? (GFX.
										     RealScreenColors
										     [Pix])
								     : GFX.
								     FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 X2[(((((GFX.
														 ScreenColors[Pix])) & (~(0x0400 |
															 0x0020 |
															 0x0001))) +
											 ((((GFX.
											     SubZBuffer[Offset + 2 * w +
											     h *
											     GFX.PPL]) & 0x20) ? (GFX.
											     SubScreen
											     [Offset
											     +
											     2 *
											     w +
											     h *
											     GFX.
											     PPL])
											   : GFX.
											   FixedColour) & (~(0x0400 | 0x0020 |
													   0x0001)))) >> 1) +
									 (((GFX.
									    ScreenColors[Pix])) & (((GFX.
											    SubZBuffer
											    [Offset +
											    2 * w +
											    h *
											    GFX.
											    PPL]) & 0x20)
									    ? (GFX.
										    SubScreen
										    [Offset +
										    2 * w +
										    h *
										    GFX.
										    PPL]) : GFX.
									    FixedColour) &
									  (0x0400 | 0x0020 | 0x0001))]);
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddF1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset + 2 * w +
										     h *
										     GFX.
										     PPL]))) & (GFX.
									     FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
											  : (((((((((GFX.ClipColors ? 0 : GFX.
																					  SubScreen[Offset + 2 * w +
																					  h *
																					  GFX.
																					  PPL]))) & (~(0x0400 |
																					  0x0020 |
																					  0x0001))) +
																	  ((GFX.
																	    FixedColour) & (~(0x0400 | 0x0020 |
																			    0x0001)))) >> 1) +
															  ((((GFX.ClipColors ? 0 : GFX.
															      SubScreen[Offset + 2 * w +
															      h *
															      GFX.PPL]))) & (GFX.
														      FixedColour)
															   & (0x0400 | 0x0020 | 0x0001))) |
														  0x0000)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 ((((GFX.ClipColors ? 0 : GFX.
										     SubScreen[Offset + 2 * w +
										     h *
										     GFX.
										     PPL]))) & (GFX.
									     FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
											  : (((((((((GFX.ClipColors ? 0 : GFX.
																					  SubScreen[Offset + 2 * w +
																					  h *
																					  GFX.
																					  PPL]))) & (~(0x0400 |
																					  0x0020 |
																					  0x0001))) +
																	  ((GFX.
																	    FixedColour) & (~(0x0400 | 0x0020 |
																			    0x0001)))) >> 1) +
															  ((((GFX.ClipColors ? 0 : GFX.
															      SubScreen[Offset + 2 * w +
															      h *
															      GFX.PPL]))) & (GFX.
														      FixedColour)
															   & (0x0400 | 0x0020 | 0x0001))) |
														  0x0000)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
										 (((GFX.
										    ScreenColors[Pix])) & (GFX.
										    FixedColour)
										  & (0x0400 | 0x0020 |
											  0x0001))])
									 : ((((((((GFX.
																	 ScreenColors[Pix])) & (~(0x0400 |
																		 0x0020 |
																		 0x0001))) +
														 ((GFX.
														   FixedColour) & (~(0x0400 | 0x0020 |
																   0x0001)))) >> 1) +
												 (((GFX.ScreenColors[Pix])) & (GFX.
													 FixedColour)
												  & (0x0400 | 0x0020 | 0x0001))) |
											 0x0000)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2AddS1_2_Hires (uint32 Left, uint32 Right, int D)
{

	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;
	GFX.RealScreenColors = IPPU.ScreenColors;
	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;
	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}
	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}
	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];
	for (Line = StartY; Line <= GFX.EndY;
			Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;
		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;
		yy =
			(((VOffset - CentreY) & 0x2000) ? ((VOffset -
					CentreY) | ~0x3ff) : ((VOffset -
						CentreY) &
					0x3ff));
		int BB =
			((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) +
			(CentreX << 8);
		int DD =
			((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) +
			(CentreY << 8);
		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}
		int xx =
			(((HOffset - CentreX) & 0x2000) ? ((HOffset -
					CentreX) | ~0x3ff) : ((HOffset -
						CentreX) &
					0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;
		if (!PPU.Mode7Repeat)
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData =
					VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   RealScreenColors[Pix])
												   : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
														   >> 1) +
														   ((((GFX.ClipColors ? 0 : GFX.
														       SubScreen[Offset + 2 * w +
														       h *
														       GFX.
														       PPL]))) &
														    (((GFX.
														       SubZBuffer[Offset +
														       2 * w +
														       h *
														       GFX.
														       PPL]) & 0x20)
														     ? (GFX.
															     RealScreenColors[Pix]) :
														     GFX.
														     FixedColour) & (0x0400 |
															     0x0020 |
															     0x0001))])
															     : (((GFX.
																			     SubZBuffer[Offset + 2 * w +
																			     h *
																			     GFX.
																			     PPL]) & 0x20)
																	     ? ((((((((GFX.ClipColors ? 0 : GFX.
																									     SubScreen[Offset + 2 * w +
																									     h *
																									     GFX.
																									     PPL]))) & (~(0x0400 |
																									     0x0020 |
																									     0x0001))) +
																					     (((GFX.
																						RealScreenColors[Pix])) & (~(0x0400
																							|
																							0x0020
																							|
																							0x0001))))
																				     >> 1) +
																			     ((((GFX.ClipColors ? 0 : GFX.
																				 SubScreen[Offset + 2 * w +
																				 h *
																				 GFX.PPL]))) & ((GFX.
																				 RealScreenColors
																				 [Pix])) &
																			      (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																			      : GFX.
																			      X2[((((((GFX.ClipColors ? 0 : GFX.
																										      SubScreen[Offset + 2 * w +
																										      h *
																										      GFX.
																										      PPL]))) & (~(0x0400 |
																										      0x0020 |
																										      0x0001))) +
																						      ((GFX.
																							FixedColour) & (~(0x0400 | 0x0020 |
																									0x0001)))) >> 1) +
																			      ((((GFX.ClipColors ? 0 : GFX.
																				  SubScreen[Offset + 2 * w +
																				  h *
																				  GFX.PPL]))) & (GFX.
																			  FixedColour)
																			       & (0x0400 | 0x0020 | 0x0001))]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		else
		{
			for (x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData =
						VRAM1 +
						(Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;
				if ((Pix = (b & 0x7f)))
				{
					for (h = MosaicStart; h < VMosaic; h++)
					{
						for (w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) >
									GFX.DB[Offset + 2 * w + h * GFX.PPL]
									&& ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[((((((GFX.
																 ClipColors ? 0 : GFX.
																 SubScreen[Offset +
																 2 * w +
																 h *
																 GFX.
																 PPL]))) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   RealScreenColors[Pix])
												   : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
														   >> 1) +
														   ((((GFX.ClipColors ? 0 : GFX.
														       SubScreen[Offset + 2 * w +
														       h *
														       GFX.
														       PPL]))) &
														    (((GFX.
														       SubZBuffer[Offset +
														       2 * w +
														       h *
														       GFX.
														       PPL]) & 0x20)
														     ? (GFX.
															     RealScreenColors[Pix]) :
														     GFX.
														     FixedColour) & (0x0400 |
															     0x0020 |
															     0x0001))])
															     : (((GFX.
																			     SubZBuffer[Offset + 2 * w +
																			     h *
																			     GFX.
																			     PPL]) & 0x20)
																	     ? ((((((((GFX.ClipColors ? 0 : GFX.
																									     SubScreen[Offset + 2 * w +
																									     h *
																									     GFX.
																									     PPL]))) & (~(0x0400 |
																									     0x0020 |
																									     0x0001))) +
																					     (((GFX.
																						RealScreenColors[Pix])) & (~(0x0400
																							|
																							0x0020
																							|
																							0x0001))))
																				     >> 1) +
																			     ((((GFX.ClipColors ? 0 : GFX.
																				 SubScreen[Offset + 2 * w +
																				 h *
																				 GFX.PPL]))) & ((GFX.
																				 RealScreenColors
																				 [Pix])) &
																			      (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																			      : GFX.
																			      X2[((((((GFX.ClipColors ? 0 : GFX.
																										      SubScreen[Offset + 2 * w +
																										      h *
																										      GFX.
																										      PPL]))) & (~(0x0400 |
																										      0x0020 |
																										      0x0001))) +
																						      ((GFX.
																							FixedColour) & (~(0x0400 | 0x0020 |
																									0x0001)))) >> 1) +
																			      ((((GFX.ClipColors ? 0 : GFX.
																				  SubScreen[Offset + 2 * w +
																				  h *
																				  GFX.PPL]))) & (GFX.
																			  FixedColour)
																			       & (0x0400 | 0x0020 | 0x0001))]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] =
									(GFX.
									 ClipColors ? (GFX.
										 X2[(((((GFX.
															 ScreenColors[Pix])) &
													 (~
													  (0x0400 | 0x0020 |
													   0x0001))) +
												 ((((GFX.
												     SubZBuffer[Offset +
												     2 * w +
												     h *
												     GFX.
												     PPL]) & 0x20)
												   ? (GFX.
													   SubScreen[Offset +
													   2 * w +
													   h *
													   GFX.
													   PPL]) : GFX.
												   FixedColour) & (~(0x0400 |
														   0x0020 |
														   0x0001))))
											 >> 1) +
											 (((GFX.
											    ScreenColors[Pix])) &
											  (((GFX.
											     SubZBuffer[Offset +
											     2 * w +
											     h *
											     GFX.
											     PPL]) & 0x20)
											   ? (GFX.
												   SubScreen[Offset +
												   2 * w +
												   h *
												   GFX.
												   PPL]) : GFX.
											   FixedColour) & (0x0400 |
												   0x0020 |
												   0x0001))])
												   : (((GFX.
																   SubZBuffer[Offset + 2 * w +
																   h *
																   GFX.
																   PPL]) & 0x20)
														   ? (((((((GFX.
																					   ScreenColors[Pix])) & (~(0x0400 |
																						   0x0020 |
																						   0x0001)))
																		   +
																		   (((GFX.
																		      SubScreen[Offset + 2 * w +
																		      h *
																		      GFX.
																		      PPL])) & (~(0x0400 |
																			      0x0020 |
																			      0x0001)))) >>
																	   1) +
																   (((GFX.ScreenColors[Pix])) & ((GFX.
																		   SubScreen
																		   [Offset +
																		   2 * w +
																		   h *
																		   GFX.
																		   PPL])) &
																    (0x0400 | 0x0020 | 0x0001))) | 0x0000)
																    : GFX.
																    X2[(((((GFX.
																						    ScreenColors[Pix])) & (~(0x0400 |
																							    0x0020 |
																							    0x0001))) +
																			    ((GFX.
																			      FixedColour) & (~(0x0400 | 0x0020 |
																					      0x0001)))) >> 1) +
																    (((GFX.ScreenColors[Pix])) & (GFX.
																	    FixedColour)
																     & (0x0400 | 0x0020 | 0x0001))]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] =
									GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] =
									(D + ((b & 0x80) ? 11 : 3));
							};
					}
				}
			}
		}
		MosaicStart = 0;
	};

}

static void DrawMode7MosaicBG2Sub_Hires (uint32 Left, uint32 Right, int D)
{
	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;

	GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;
	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}

	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];

	for ( Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;

		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;

		yy = (((VOffset - CentreY) & 0x2000) ? ((VOffset - CentreY) | ~0x3ff) : ((VOffset - CentreY) & 0x3ff));
		int BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) + (CentreX << 8);
		int DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) + (CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1; aa = -l->MatrixA; cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft; aa = l->MatrixA; cc = l->MatrixC;
		}

		int xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset - CentreX) & 0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;

		if (!PPU.Mode7Repeat)
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;

				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.RealScreenColors[Pix]) : GFX.FixedColour));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (COLOR_SUB((GFX.ScreenColors[Pix]), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]) : GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		else
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;

				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;

				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.RealScreenColors[Pix]) : GFX.FixedColour));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (COLOR_SUB((GFX.ScreenColors[Pix]), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]) : GFX.FixedColour));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		MosaicStart = 0;
	}
}

static void DrawMode7MosaicBG2SubF1_2_Hires (uint32 Left, uint32 Right, int D)
{
	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;

	GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}

	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];

	for ( Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;

		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else
			starty = Line + 1;

		yy = (((VOffset - CentreY) & 0x2000) ? ((VOffset - CentreY) | ~0x3ff) : ((VOffset - CentreY) & 0x3ff));

		int BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) + (CentreX << 8);
		int DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) + (CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}

		int xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset - CentreX) & 0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);
		uint8 Pix;
		uint8 ctr = 1;

		if (!PPU.Mode7Repeat)
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;

				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));

				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (GFX.ClipColors ? (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), GFX.FixedColour)) : (GFX.ZERO[(((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]))) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (GFX.ClipColors ? (COLOR_SUB((GFX.ScreenColors[Pix]), GFX.FixedColour)) : (GFX.ZERO[((((GFX.ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		else
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;

				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if(PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;

				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (GFX.ClipColors ? (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), GFX.FixedColour)) : (GFX.ZERO[(((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]))) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (GFX.ClipColors ? (COLOR_SUB((GFX.ScreenColors[Pix]), GFX.FixedColour)) : (GFX.ZERO[((((GFX.ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - ((GFX.FixedColour) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1]));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				} }
		}
		MosaicStart = 0;
	}
}

static void DrawMode7MosaicBG2SubS1_2_Hires (uint32 Left, uint32 Right, int D)
{
	uint32 Line;
	int32 h, w, x;
	uint8 *VRAM1 = Memory.VRAM + 1;

	GFX.RealScreenColors = IPPU.ScreenColors;

	GFX.ScreenColors = GFX.ClipColors ? BlackColourMap : GFX.RealScreenColors;

	int aa, cc;
	int startx, StartY = GFX.StartY;
	int HMosaic = 1, VMosaic = 1, MosaicStart = 0;
	int32 MLeft = Left, MRight = Right;

	if (PPU.BGMosaic[0])
	{
		VMosaic = PPU.Mosaic;
		MosaicStart = ((uint32) GFX.StartY - PPU.MosaicStart) % VMosaic;
		StartY -= MosaicStart;
	}

	if (PPU.BGMosaic[1])
	{
		HMosaic = PPU.Mosaic;
		MLeft -= MLeft % HMosaic;
		MRight += HMosaic - 1;
		MRight -= MRight % HMosaic;
	}

	uint32 Offset = StartY * GFX.PPL;
	struct SLineMatrixData *l = &LineMatrixData[StartY];

	for ( Line = StartY; Line <= GFX.EndY; Line += VMosaic, Offset += VMosaic * GFX.PPL, l += VMosaic)
	{
		if (Line + VMosaic > GFX.EndY)
			VMosaic = GFX.EndY - Line + 1;
		int yy, starty;
		int32 HOffset = ((int32) l->M7HOFS << 19) >> 19;
		int32 VOffset = ((int32) l->M7VOFS << 19) >> 19;
		int32 CentreX = ((int32) l->CentreX << 19) >> 19;
		int32 CentreY = ((int32) l->CentreY << 19) >> 19;

		if (PPU.Mode7VFlip)
			starty = 255 - (int) (Line + 1);
		else starty = Line + 1;

		yy = (((VOffset - CentreY) & 0x2000) ? ((VOffset - CentreY) | ~0x3ff) : ((VOffset - CentreY) & 0x3ff));
		int BB = ((l->MatrixB * starty) & ~63) + ((l->MatrixB * yy) & ~63) + (CentreX << 8);
		int DD = ((l->MatrixD * starty) & ~63) + ((l->MatrixD * yy) & ~63) + (CentreY << 8);

		if (PPU.Mode7HFlip)
		{
			startx = MRight - 1;
			aa = -l->MatrixA;
			cc = -l->MatrixC;
		}
		else
		{
			startx = MLeft;
			aa = l->MatrixA;
			cc = l->MatrixC;
		}

		int xx = (((HOffset - CentreX) & 0x2000) ? ((HOffset - CentreX) | ~0x3ff) : ((HOffset - CentreX) & 0x3ff));
		int AA = l->MatrixA * startx + ((l->MatrixA * xx) & ~63);
		int CC = l->MatrixC * startx + ((l->MatrixC * xx) & ~63);

		uint8 Pix;
		uint8 ctr = 1;

		if (!PPU.Mode7Repeat)
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8) & 0x3ff;
				int Y = ((CC + DD) >> 8) & 0x3ff;
				uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
				uint8 b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (GFX.ClipColors ? (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.RealScreenColors[Pix]) : GFX.FixedColour)) : (((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? GFX.ZERO[(((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]))) | ((0x4000 | 0x0200 | 0x0010) << 1)) - (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1] : COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), GFX.FixedColour)));

								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (GFX.ClipColors ? (COLOR_SUB((GFX.ScreenColors[Pix]), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]) : GFX.FixedColour)) : (((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? GFX.ZERO[((((GFX.ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - (((GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1] : COLOR_SUB((GFX.ScreenColors[Pix]), GFX.FixedColour))); GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		else
		{
			for ( x = MLeft; x < MRight; x++, AA += aa, CC += cc)
			{
				if (--ctr)
					continue;
				ctr = HMosaic;
				int X = ((AA + BB) >> 8);
				int Y = ((CC + DD) >> 8);
				uint8 b;
				if (((X | Y) & ~0x3ff) == 0)
				{
					uint8 *TileData = VRAM1 + (Memory.VRAM[((Y & ~7) << 5) + ((X >> 2) & ~1)] << 7);
					b = *(TileData + ((Y & 7) << 4) + ((X & 7) << 1));
				}
				else if (PPU.Mode7Repeat == 3)
					b = *(VRAM1 + ((Y & 7) << 4) + ((X & 7) << 1));
				else
					continue;

				if ((Pix = (b & 0x7f)))
				{
					for ( h = MosaicStart; h < VMosaic; h++)
					{
						for ( w = x + HMosaic - 1; w >= x; w--)
							if ((D + ((b & 0x80) ? 11 : 3)) > GFX.DB[Offset + 2 * w + h * GFX.PPL] && ((w >= (int32) Left && w < (int32) Right)))
							{
								GFX.S[Offset + 2 * w + h * GFX.PPL] = (GFX.ClipColors ? (COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.RealScreenColors[Pix]) : GFX.FixedColour)) : (((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? GFX.ZERO[(((((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]))) | ((0x4000 | 0x0200 | 0x0010) << 1)) - (((GFX.RealScreenColors[Pix])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1] : COLOR_SUB(((GFX.ClipColors ? 0 : GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])), GFX.FixedColour)));
								GFX.S[Offset + 2 * w + h * GFX.PPL + 1] = (GFX.ClipColors ? (COLOR_SUB((GFX.ScreenColors[Pix]), ((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? (GFX.SubScreen[Offset + 2 * w + h * GFX.PPL]) : GFX.FixedColour)) : (((GFX.SubZBuffer[Offset + 2 * w + h * GFX.PPL]) & 0x20) ? GFX.ZERO[((((GFX.ScreenColors[Pix])) | ((0x4000 | 0x0200 | 0x0010) << 1)) - (((GFX.SubScreen[Offset + 2 * w + h * GFX.PPL])) & (~(0x0400 | 0x0020 | 0x0001)))) >> 1] : COLOR_SUB((GFX.ScreenColors[Pix]), GFX.FixedColour)));
								GFX.DB[Offset + 2 * w + h * GFX.PPL] = GFX.DB[Offset + 2 * w + h * GFX.PPL + 1] = (D + ((b & 0x80) ? 11 : 3));
							}
					}
				}
			}
		}
		MosaicStart = 0;
	}
}

static void (*Renderers_DrawMode7MosaicBG2Hires[7]) (uint32 Left, uint32 Right, int D) =
{
 DrawMode7MosaicBG2_Hires,
 DrawMode7MosaicBG2Add_Hires,
 DrawMode7MosaicBG2AddF1_2_Hires,
 DrawMode7MosaicBG2AddS1_2_Hires,
 DrawMode7MosaicBG2Sub_Hires,
 DrawMode7MosaicBG2SubF1_2_Hires,
 DrawMode7MosaicBG2SubS1_2_Hires
};

void S9xSelectTileRenderers_SFXSpeedup()
{
	void	(**DT)		(uint32, uint32, uint32, uint32);
	void	(**DCT)		(uint32, uint32, uint32, uint32, uint32, uint32);
	void	(**DB)		(uint32, uint32, uint32);
	int i;

	DT     = Renderers_DrawTile16Normal1x1;
	DCT    = Renderers_DrawClippedTile16Normal1x1;
	DB     = Renderers_DrawBackdrop16Normal1x1;
	GFX.LinesPerTile = 8;

	GFX.DrawTileNomath        = DT[0];
	GFX.DrawClippedTileNomath = DCT[0];
	GFX.DrawBackdropNomath    = DB[0];

	i = (Memory.FillRAM[0x2131] & 0x80) ? 4 : 1;
	if (Memory.FillRAM[0x2131] & 0x40)
	{
		i++;
		if (Memory.FillRAM[0x2130] & 2)
			i++;
	}

	GFX.DrawTileMath        = DT[i];
	GFX.DrawClippedTileMath = DCT[i];
	GFX.DrawBackdropMath    = DB[i];
}

void S9xSelectTileRenderers (int BGMode, bool8 sub, bool8 obj)
{
	void	(**DT)		(uint32, uint32, uint32, uint32);
	void	(**DCT)		(uint32, uint32, uint32, uint32, uint32, uint32);
	void	(**DMP)		(uint32, uint32, uint32, uint32, uint32, uint32);
	void	(**DB)		(uint32, uint32, uint32);
	void	(**DM7BG1)	(uint32, uint32, int);
	void	(**DM7BG2)	(uint32, uint32, int);
	bool8	M7M1, M7M2, interlace, hires;
	int i;

	M7M1 = PPU.BGMosaic[0] && PPU.Mosaic > 1;
	M7M2 = PPU.BGMosaic[1] && PPU.Mosaic > 1;

	interlace = obj ? FALSE : IPPU.Interlace;
	hires = !sub && (BGMode == 5 || BGMode == 6 || IPPU.PseudoHires);

	if (!IPPU.DoubleWidthPixels)	/* normal width */
	{
		DT     = Renderers_DrawTile16Normal1x1;
		DCT    = Renderers_DrawClippedTile16Normal1x1;
		DMP    = Renderers_DrawMosaicPixel16Normal1x1;
		DB     = Renderers_DrawBackdrop16Normal1x1;
		DM7BG1 = M7M1 ? Renderers_DrawMode7MosaicBG1Normal1x1 : Renderers_DrawMode7BG1Normal1x1;
		DM7BG2 = M7M2 ? Renderers_DrawMode7MosaicBG2Normal1x1 : Renderers_DrawMode7BG2Normal1x1;
		GFX.LinesPerTile = 8;
	}
	else if(hires)			/* hires double width */
	{
		if (interlace)
		{
			DT     = Renderers_DrawTile16HiresInterlace;
			DCT    = Renderers_DrawClippedTile16HiresInterlace;
			DMP    = Renderers_DrawMosaicPixel16HiresInterlace;
			DB     = Renderers_DrawBackdrop16Hires;
			DM7BG1 = M7M1 ? Renderers_DrawMode7MosaicBG1Hires : Renderers_DrawMode7BG1Hires;
			DM7BG2 = M7M2 ? Renderers_DrawMode7MosaicBG2Hires : Renderers_DrawMode7BG2Hires;
			GFX.LinesPerTile = 4;
		}
		else
		{
			DT     = Renderers_DrawTile16Hires;
			DCT    = Renderers_DrawClippedTile16Hires;
			DMP    = Renderers_DrawMosaicPixel16Hires;
			DB     = Renderers_DrawBackdrop16Hires;
			DM7BG1 = M7M1 ? Renderers_DrawMode7MosaicBG1Hires : Renderers_DrawMode7BG1Hires;
			DM7BG2 = M7M2 ? Renderers_DrawMode7MosaicBG2Hires : Renderers_DrawMode7BG2Hires;
			GFX.LinesPerTile = 8;
		}
	}
	else
	{
		if (interlace)
		{
			DT     = Renderers_DrawTile16Interlace;
			DCT    = Renderers_DrawClippedTile16Interlace;
			DMP    = Renderers_DrawMosaicPixel16Interlace;
			DB     = Renderers_DrawBackdrop16Normal2x1;
			DM7BG1 = M7M1 ? Renderers_DrawMode7MosaicBG1Normal2x1 : Renderers_DrawMode7BG1Normal2x1;
			DM7BG2 = M7M2 ? Renderers_DrawMode7MosaicBG2Normal2x1 : Renderers_DrawMode7BG2Normal2x1;
			GFX.LinesPerTile = 4;
		}
		else
		{
			DT     = Renderers_DrawTile16Normal2x1;
			DCT    = Renderers_DrawClippedTile16Normal2x1;
			DMP    = Renderers_DrawMosaicPixel16Normal2x1;
			DB     = Renderers_DrawBackdrop16Normal2x1;
			DM7BG1 = M7M1 ? Renderers_DrawMode7MosaicBG1Normal2x1 : Renderers_DrawMode7BG1Normal2x1;
			DM7BG2 = M7M2 ? Renderers_DrawMode7MosaicBG2Normal2x1 : Renderers_DrawMode7BG2Normal2x1;
			GFX.LinesPerTile = 8;
		}
	}

	GFX.DrawTileNomath        = DT[0];
	GFX.DrawClippedTileNomath = DCT[0];
	GFX.DrawMosaicPixelNomath = DMP[0];
	GFX.DrawBackdropNomath    = DB[0];
	GFX.DrawMode7BG1Nomath    = DM7BG1[0];
	GFX.DrawMode7BG2Nomath    = DM7BG2[0];

	i = (Memory.FillRAM[0x2131] & 0x80) ? 4 : 1;
	if (Memory.FillRAM[0x2131] & 0x40)
	{
		i++;
		if (Memory.FillRAM[0x2130] & 2)
			i++;
	}

	GFX.DrawTileMath        = DT[i];
	GFX.DrawClippedTileMath = DCT[i];
	GFX.DrawMosaicPixelMath = DMP[i];
	GFX.DrawBackdropMath    = DB[i];
	GFX.DrawMode7BG1Math    = DM7BG1[i];
	GFX.DrawMode7BG2Math    = DM7BG2[i];
}

void S9xSelectTileConverter_SFXDepth4()
{
	BG.ConvertTile = BG.ConvertTileFlip = ConvertTile4;
	BG.Buffer      = BG.BufferFlip      = IPPU.TileCache[TILE_4BIT];
	BG.Buffered    = BG.BufferedFlip    = IPPU.TileCached[TILE_4BIT];
	BG.TileShift        = 5;
	BG.PaletteShift     = 10 - 4;
	BG.PaletteMask      = 7 << 4;
	BG.DirectColourMode = FALSE;
}

void S9xSelectTileConverter_SFXDepth2()
{
	BG.ConvertTile = BG.ConvertTileFlip = ConvertTile2;
	BG.Buffer      = BG.BufferFlip      = IPPU.TileCache[TILE_2BIT];
	BG.Buffered    = BG.BufferedFlip    = IPPU.TileCached[TILE_2BIT];
	BG.TileShift        = 4;
	BG.PaletteShift     = 10 - 2;
	BG.PaletteMask      = 7 << 2;
	BG.DirectColourMode = FALSE;
}

void S9xSelectTileConverter (int depth, bool8 hires, bool8 sub, bool8 mosaic)
{
	switch (depth)
	{
		case 8:
			BG.ConvertTile      = BG.ConvertTileFlip = ConvertTile8;
			BG.Buffer           = BG.BufferFlip      = IPPU.TileCache[TILE_8BIT];
			BG.Buffered         = BG.BufferedFlip    = IPPU.TileCached[TILE_8BIT];
			BG.TileShift        = 6;
			BG.PaletteShift     = 0;
			BG.PaletteMask      = 0;
			BG.DirectColourMode = Memory.FillRAM[0x2130] & 1;

			break;

		case 4:
			if (hires)
			{
				if (sub || mosaic)
				{
					BG.ConvertTile     = ConvertTile4h_even;
					BG.Buffer          = IPPU.TileCache[TILE_4BIT_EVEN];
					BG.Buffered        = IPPU.TileCached[TILE_4BIT_EVEN];
					BG.ConvertTileFlip = ConvertTile4h_odd;
					BG.BufferFlip      = IPPU.TileCache[TILE_4BIT_ODD];
					BG.BufferedFlip    = IPPU.TileCached[TILE_4BIT_ODD];
				}
				else
				{
					BG.ConvertTile     = ConvertTile4h_odd;
					BG.Buffer          = IPPU.TileCache[TILE_4BIT_ODD];
					BG.Buffered        = IPPU.TileCached[TILE_4BIT_ODD];
					BG.ConvertTileFlip = ConvertTile4h_even;
					BG.BufferFlip      = IPPU.TileCache[TILE_4BIT_EVEN];
					BG.BufferedFlip    = IPPU.TileCached[TILE_4BIT_EVEN];
				}
			}
			else
			{
				BG.ConvertTile = BG.ConvertTileFlip = ConvertTile4;
				BG.Buffer      = BG.BufferFlip      = IPPU.TileCache[TILE_4BIT];
				BG.Buffered    = BG.BufferedFlip    = IPPU.TileCached[TILE_4BIT];
			}

			BG.TileShift        = 5;
			BG.PaletteShift     = 10 - 4;
			BG.PaletteMask      = 7 << 4;
			BG.DirectColourMode = FALSE;

			break;

		case 2:
			if (hires)
			{
				if (sub || mosaic)
				{
					BG.ConvertTile     = ConvertTile2h_even;
					BG.Buffer          = IPPU.TileCache[TILE_2BIT_EVEN];
					BG.Buffered        = IPPU.TileCached[TILE_2BIT_EVEN];
					BG.ConvertTileFlip = ConvertTile2h_odd;
					BG.BufferFlip      = IPPU.TileCache[TILE_2BIT_ODD];
					BG.BufferedFlip    = IPPU.TileCached[TILE_2BIT_ODD];
				}
				else
				{
					BG.ConvertTile     = ConvertTile2h_odd;
					BG.Buffer          = IPPU.TileCache[TILE_2BIT_ODD];
					BG.Buffered        = IPPU.TileCached[TILE_2BIT_ODD];
					BG.ConvertTileFlip = ConvertTile2h_even;
					BG.BufferFlip      = IPPU.TileCache[TILE_2BIT_EVEN];
					BG.BufferedFlip    = IPPU.TileCached[TILE_2BIT_EVEN];
				}
			}
			else
			{
				BG.ConvertTile = BG.ConvertTileFlip = ConvertTile2;
				BG.Buffer      = BG.BufferFlip      = IPPU.TileCache[TILE_2BIT];
				BG.Buffered    = BG.BufferedFlip    = IPPU.TileCached[TILE_2BIT];
			}

			BG.TileShift        = 4;
			BG.PaletteShift     = 10 - 2;
			BG.PaletteMask      = 7 << 2;
			BG.DirectColourMode = FALSE;

			break;
	}
}
